---
title: 组件封装实践
icon: component
order: 3
---

# 组件封装实践

## 概述

组件封装是前端开发中的重要环节，特别是在中后台系统开发中，良好的组件封装能够显著提高开发效率、代码复用性和系统可维护性。本文档将详细介绍中后台系统中常见组件的封装思路和实践经验，包括业务组件设计原则、通用表格组件、高级表单组件、权限按钮组件等内容，帮助开发者构建高质量的组件库。

## 业务组件设计原则

### 单一职责原则

每个组件应该只负责一个功能领域，这样可以保持组件的简单性和可维护性。

- **好的实践**：将表格和分页分为两个组件，然后在父组件中组合使用
- **不好的实践**：一个组件同时处理表格展示、数据过滤、分页和编辑功能

### 可配置性原则

组件应该提供足够的配置选项，以适应不同的业务场景。

```vue
<!-- 高可配置性的按钮组件示例 -->
<template>
  <el-button
    :type="type"
    :size="size"
    :icon="icon"
    :loading="loading"
    :disabled="disabled || !hasPermission"
    @click="handleClick"
  >
    <slot>{{ text }}</slot>
  </el-button>
</template>

<script setup>
import { computed } from 'vue';
import { usePermissionStore } from '@/stores/permission';

const props = defineProps({
  // 按钮类型
  type: {
    type: String,
    default: 'default'
  },
  // 按钮大小
  size: {
    type: String,
    default: 'default'
  },
  // 按钮图标
  icon: {
    type: String,
    default: ''
  },
  // 按钮文本
  text: {
    type: String,
    default: '按钮'
  },
  // 加载状态
  loading: {
    type: Boolean,
    default: false
  },
  // 禁用状态
  disabled: {
    type: Boolean,
    default: false
  },
  // 权限标识
  permission: {
    type: String,
    default: ''
  }
});

const emit = defineEmits(['click']);

// 权限验证
const permissionStore = usePermissionStore();
const hasPermission = computed(() => {
  if (!props.permission) return true;
  return permissionStore.hasPermission(props.permission);
});

// 点击事件处理
const handleClick = (event) => {
  emit('click', event);
};
</script>
```

### 组合优于继承

使用组合模式而非继承来实现功能扩展，这样可以保持组件的灵活性。

```vue
<!-- 使用组合模式的表单项组件 -->
<template>
  <div class="form-item-wrapper">
    <el-form-item :label="label" :prop="prop" :rules="rules">
      <!-- 根据类型渲染不同的表单控件 -->
      <component 
        :is="componentMap[type]" 
        v-bind="$attrs"
        v-model="modelValue"
        @update:modelValue="updateValue"
      />
    </el-form-item>
  </div>
</template>

<script setup>
import { computed } from 'vue';
import { ElInput, ElSelect, ElDatePicker, ElSwitch } from 'element-plus';

// 组件映射表
const componentMap = {
  input: ElInput,
  select: ElSelect,
  datePicker: ElDatePicker,
  switch: ElSwitch
};

const props = defineProps({
  modelValue: {
    type: [String, Number, Boolean, Array, Object],
    default: ''
  },
  label: {
    type: String,
    default: ''
  },
  prop: {
    type: String,
    default: ''
  },
  type: {
    type: String,
    default: 'input'
  },
  rules: {
    type: Array,
    default: () => []
  }
});

const emit = defineEmits(['update:modelValue']);

// 更新值
const updateValue = (val) => {
  emit('update:modelValue', val);
};
</script>
```

### 接口一致性原则

保持组件接口的一致性，使用相似的属性名和事件名，降低学习成本。

- 所有表单组件都使用 `v-model` 进行双向绑定
- 所有列表组件都提供 `data`、`loading`、`pagination` 等属性
- 事件命名保持一致，如 `@change`、`@select`、`@submit` 等

### 可测试性原则

组件应该易于测试，避免复杂的内部状态和副作用。

```javascript
// 可测试的组件示例
import { mount } from '@vue/test-utils';
import MyButton from '@/components/MyButton.vue';

describe('MyButton.vue', () => {
  it('renders button text correctly', () => {
    const text = '测试按钮';
    const wrapper = mount(MyButton, {
      props: { text }
    });
    expect(wrapper.text()).toContain(text);
  });

  it('emits click event when clicked', async () => {
    const wrapper = mount(MyButton);
    await wrapper.trigger('click');
    expect(wrapper.emitted('click')).toBeTruthy();
  });

  it('disables button when disabled prop is true', () => {
    const wrapper = mount(MyButton, {
      props: { disabled: true }
    });
    expect(wrapper.find('button').element.disabled).toBe(true);
  });
});
```

### 文档完善原则

为组件提供完善的文档和示例，包括属性、事件、插槽和使用示例。

```javascript
/**
 * 表格组件
 * @component
 * @example
 * <my-table
 *   :data="tableData"
 *   :columns="columns"
 *   :loading="loading"
 *   :pagination="pagination"
 *   @page-change="handlePageChange"
 * />
 */
```

## 通用表格组件封装

表格是中后台系统中最常用的组件之一，封装一个功能完善的表格组件可以大幅提高开发效率。

### 基础表格组件

```vue
<!-- src/components/Table/index.vue -->
<template>
  <div class="table-container">
    <!-- 表格工具栏 -->
    <div class="table-toolbar" v-if="$slots.toolbar">
      <slot name="toolbar"></slot>
    </div>
    
    <!-- 表格主体 -->
    <el-table
      v-bind="$attrs"
      :data="data"
      :border="border"
      :stripe="stripe"
      :height="height"
      :max-height="maxHeight"
      :row-key="rowKey"
      v-loading="loading"
      @selection-change="handleSelectionChange"
      @sort-change="handleSortChange"
      @row-click="handleRowClick"
    >
      <!-- 选择列 -->
      <el-table-column
        v-if="showSelection"
        type="selection"
        width="55"
        align="center"
        fixed="left"
      />
      
      <!-- 序号列 -->
      <el-table-column
        v-if="showIndex"
        type="index"
        width="60"
        label="序号"
        align="center"
        :index="getIndex"
      />
      
      <!-- 动态列 -->
      <template v-for="(column, index) in columns" :key="index">
        <el-table-column
          :prop="column.prop"
          :label="column.label"
          :width="column.width"
          :min-width="column.minWidth"
          :fixed="column.fixed"
          :sortable="column.sortable"
          :align="column.align || 'left'"
          :show-overflow-tooltip="column.showOverflowTooltip !== false"
        >
          <template #default="scope">
            <!-- 自定义列插槽 -->
            <slot
              :name="column.slotName || column.prop"
              :row="scope.row"
              :column="column"
              :$index="scope.$index"
            >
              <!-- 根据列类型渲染不同内容 -->
              <template v-if="column.type === 'image'">
                <el-image
                  :src="scope.row[column.prop]"
                  :preview-src-list="[scope.row[column.prop]]"
                  fit="cover"
                  :style="{ width: '50px', height: '50px' }"
                />
              </template>
              
              <template v-else-if="column.type === 'tag'">
                <el-tag
                  :type="getTagType(scope.row[column.prop], column.options)"
                >
                  {{ getTagText(scope.row[column.prop], column.options) }}
                </el-tag>
              </template>
              
              <template v-else-if="column.type === 'date'">
                {{ formatDate(scope.row[column.prop], column.format) }}
              </template>
              
              <template v-else>
                {{ scope.row[column.prop] }}
              </template>
            </slot>
          </template>
        </el-table-column>
      </template>
      
      <!-- 操作列 -->
      <el-table-column
        v-if="$slots.operation"
        :label="operationLabel"
        :width="operationWidth"
        :fixed="operationFixed"
        align="center"
      >
        <template #default="scope">
          <slot name="operation" :row="scope.row" :$index="scope.$index"></slot>
        </template>
      </el-table-column>
    </el-table>
    
    <!-- 分页 -->
    <div class="table-pagination" v-if="showPagination">
      <el-pagination
        v-model:current-page="currentPage"
        v-model:page-size="pageSize"
        :page-sizes="pageSizes"
        :total="total"
        :layout="paginationLayout"
        @size-change="handleSizeChange"
        @current-change="handleCurrentChange"
      />
    </div>
  </div>
</template>

<script setup>
import { ref, computed, watch } from 'vue';
import { formatDate as formatDateUtil } from '@/utils/date';

const props = defineProps({
  // 表格数据
  data: {
    type: Array,
    default: () => []
  },
  // 表格列配置
  columns: {
    type: Array,
    default: () => []
  },
  // 加载状态
  loading: {
    type: Boolean,
    default: false
  },
  // 是否显示边框
  border: {
    type: Boolean,
    default: true
  },
  // 是否显示斑马纹
  stripe: {
    type: Boolean,
    default: true
  },
  // 表格高度
  height: {
    type: [String, Number],
    default: ''
  },
  // 表格最大高度
  maxHeight: {
    type: [String, Number],
    default: ''
  },
  // 行数据的Key
  rowKey: {
    type: String,
    default: 'id'
  },
  // 是否显示选择列
  showSelection: {
    type: Boolean,
    default: false
  },
  // 是否显示序号列
  showIndex: {
    type: Boolean,
    default: false
  },
  // 操作列标题
  operationLabel: {
    type: String,
    default: '操作'
  },
  // 操作列宽度
  operationWidth: {
    type: [String, Number],
    default: 150
  },
  // 操作列是否固定
  operationFixed: {
    type: [Boolean, String],
    default: 'right'
  },
  // 是否显示分页
  showPagination: {
    type: Boolean,
    default: true
  },
  // 分页配置
  pagination: {
    type: Object,
    default: () => ({
      currentPage: 1,
      pageSize: 10,
      total: 0
    })
  },
  // 分页大小选项
  pageSizes: {
    type: Array,
    default: () => [10, 20, 50, 100]
  },
  // 分页布局
  paginationLayout: {
    type: String,
    default: 'total, sizes, prev, pager, next, jumper'
  }
});

const emit = defineEmits([
  'selection-change',
  'sort-change',
  'row-click',
  'page-change',
  'size-change'
]);

// 分页相关
const currentPage = ref(props.pagination.currentPage || 1);
const pageSize = ref(props.pagination.pageSize || 10);
const total = computed(() => props.pagination.total || 0);

// 监听分页配置变化
watch(
  () => props.pagination,
  (newVal) => {
    if (newVal) {
      currentPage.value = newVal.currentPage || 1;
      pageSize.value = newVal.pageSize || 10;
    }
  },
  { deep: true }
);

// 获取序号
const getIndex = (index) => {
  return (currentPage.value - 1) * pageSize.value + index + 1;
};

// 处理选择变化
const handleSelectionChange = (selection) => {
  emit('selection-change', selection);
};

// 处理排序变化
const handleSortChange = (sort) => {
  emit('sort-change', sort);
};

// 处理行点击
const handleRowClick = (row, column, event) => {
  emit('row-click', row, column, event);
};

// 处理页码变化
const handleCurrentChange = (page) => {
  emit('page-change', { page, size: pageSize.value });
};

// 处理每页条数变化
const handleSizeChange = (size) => {
  emit('size-change', { page: currentPage.value, size });
  emit('page-change', { page: currentPage.value, size });
};

// 格式化日期
const formatDate = (date, format = 'YYYY-MM-DD HH:mm:ss') => {
  if (!date) return '';
  return formatDateUtil(date, format);
};

// 获取标签类型
const getTagType = (value, options = []) => {
  if (!options || options.length === 0) return '';
  const option = options.find(item => item.value === value);
  return option ? option.type : '';
};

// 获取标签文本
const getTagText = (value, options = []) => {
  if (!options || options.length === 0) return value;
  const option = options.find(item => item.value === value);
  return option ? option.label : value;
};
</script>

<style scoped>
.table-container {
  width: 100%;
}

.table-toolbar {
  margin-bottom: 16px;
}

.table-pagination {
  margin-top: 16px;
  display: flex;
  justify-content: flex-end;
}
</style>
```

### 使用示例

```vue
<template>
  <div class="user-list">
    <my-table
      :data="tableData"
      :columns="columns"
      :loading="loading"
      :pagination="pagination"
      show-selection
      show-index
      @selection-change="handleSelectionChange"
      @page-change="handlePageChange"
    >
      <!-- 工具栏插槽 -->
      <template #toolbar>
        <el-button type="primary" @click="handleAdd">新增用户</el-button>
        <el-button type="danger" :disabled="!selectedRows.length" @click="handleBatchDelete">批量删除</el-button>
      </template>
      
      <!-- 自定义状态列 -->
      <template #status="{ row }">
        <el-switch
          v-model="row.status"
          :active-value="1"
          :inactive-value="0"
          @change="(val) => handleStatusChange(row, val)"
        />
      </template>
      
      <!-- 操作列插槽 -->
      <template #operation="{ row }">
        <el-button type="primary" size="small" @click="handleEdit(row)">编辑</el-button>
        <el-button type="danger" size="small" @click="handleDelete(row)">删除</el-button>
      </template>
    </my-table>
  </div>
</template>

<script setup>
import { ref, reactive, onMounted } from 'vue';
import MyTable from '@/components/Table/index.vue';
import { getUserList, updateUserStatus, deleteUser } from '@/api/user';
import { ElMessage, ElMessageBox } from 'element-plus';

// 表格数据
const tableData = ref([]);
const loading = ref(false);
const selectedRows = ref([]);

// 分页配置
const pagination = reactive({
  currentPage: 1,
  pageSize: 10,
  total: 0
});

// 表格列配置
const columns = [
  { prop: 'username', label: '用户名', minWidth: 100 },
  { prop: 'nickname', label: '昵称', minWidth: 100 },
  { prop: 'email', label: '邮箱', minWidth: 150 },
  { prop: 'phone', label: '手机号', minWidth: 120 },
  { 
    prop: 'gender', 
    label: '性别', 
    width: 80,
    type: 'tag',
    options: [
      { value: 1, label: '男', type: 'primary' },
      { value: 2, label: '女', type: 'success' },
      { value: 0, label: '未知', type: 'info' }
    ]
  },
  { 
    prop: 'status', 
    label: '状态', 
    width: 80,
    slotName: 'status'
  },
  { 
    prop: 'createTime', 
    label: '创建时间', 
    minWidth: 160,
    type: 'date',
    format: 'YYYY-MM-DD HH:mm:ss'
  }
];

// 获取用户列表
const fetchUserList = async () => {
  loading.value = true;
  try {
    const { data } = await getUserList({
      pageNum: pagination.currentPage,
      pageSize: pagination.pageSize
    });
    tableData.value = data.list;
    pagination.total = data.total;
  } catch (error) {
    console.error('获取用户列表失败:', error);
    ElMessage.error('获取用户列表失败');
  } finally {
    loading.value = false;
  }
};

// 处理页码变化
const handlePageChange = ({ page, size }) => {
  pagination.currentPage = page;
  pagination.pageSize = size;
  fetchUserList();
};

// 处理选择变化
const handleSelectionChange = (selection) => {
  selectedRows.value = selection;
};

// 处理状态变化
const handleStatusChange = async (row, value) => {
  try {
    await updateUserStatus(row.id, value);
    ElMessage.success('更新状态成功');
  } catch (error) {
    console.error('更新状态失败:', error);
    ElMessage.error('更新状态失败');
    // 恢复原状态
    row.status = row.status === 1 ? 0 : 1;
  }
};

// 处理删除
const handleDelete = (row) => {
  ElMessageBox.confirm('确定要删除该用户吗？', '提示', {
    confirmButtonText: '确定',
    cancelButtonText: '取消',
    type: 'warning'
  }).then(async () => {
    try {
      await deleteUser(row.id);
      ElMessage.success('删除成功');
      fetchUserList();
    } catch (error) {
      console.error('删除失败:', error);
      ElMessage.error('删除失败');
    }
  }).catch(() => {});
};

// 处理批量删除
const handleBatchDelete = () => {
  if (selectedRows.value.length === 0) {
    ElMessage.warning('请选择要删除的用户');
    return;
  }
  
  ElMessageBox.confirm(`确定要删除选中的 ${selectedRows.value.length} 个用户吗？`, '提示', {
    confirmButtonText: '确定',
    cancelButtonText: '取消',
    type: 'warning'
  }).then(async () => {
    // 批量删除逻辑
  }).catch(() => {});
};

// 处理新增
const handleAdd = () => {
  // 新增用户逻辑
};

// 处理编辑
const handleEdit = (row) => {
  // 编辑用户逻辑
};

// 初始化
onMounted(() => {
  fetchUserList();
});
</script>
```

### 表格组件进阶功能

#### 拖拽排序

```vue
<!-- 拖拽排序表格 -->
<template>
  <div class="draggable-table">
    <my-table
      ref="tableRef"
      v-bind="$attrs"
      :data="tableData"
      row-key="id"
      @row-click="handleRowClick"
    >
      <template v-for="(_, name) in $slots" #[name]="slotData">
        <slot :name="name" v-bind="slotData"></slot>
      </template>
    </my-table>
  </div>
</template>

<script setup>
import { ref, computed, onMounted, nextTick } from 'vue';
import Sortable from 'sortablejs';
import MyTable from '@/components/Table/index.vue';

const props = defineProps({
  data: {
    type: Array,
    default: () => []
  },
  draggable: {
    type: Boolean,
    default: true
  }
});

const emit = defineEmits(['update:data', 'row-click', 'row-sort']);

// 表格引用
const tableRef = ref(null);

// 表格数据
const tableData = computed({
  get: () => props.data,
  set: (val) => emit('update:data', val)
});

// 初始化拖拽
const initSortable = () => {
  if (!props.draggable) return;
  
  nextTick(() => {
    const el = tableRef.value.$el.querySelector('.el-table__body tbody');
    if (!el) return;
    
    Sortable.create(el, {
      handle: '.el-table__row',
      animation: 300,
      onEnd: ({ newIndex, oldIndex }) => {
        const newData = [...tableData.value];
        const currRow = newData.splice(oldIndex, 1)[0];
        newData.splice(newIndex, 0, currRow);
        tableData.value = newData;
        emit('row-sort', { newIndex, oldIndex, newData });
      }
    });
  });
};

// 处理行点击
const handleRowClick = (row, column, event) => {
  emit('row-click', row, column, event);
};

// 初始化
onMounted(() => {
  initSortable();
});
</script>

<style scoped>
.draggable-table :deep(.el-table__row) {
  cursor: move;
}
</style>
```

#### 表格列设置

```vue
<!-- 表格列设置组件 -->
<template>
  <div class="column-setting">
    <el-popover
      placement="bottom-end"
      :width="200"
      trigger="click"
      popper-class="column-setting-popover"
    >
      <template #reference>
        <el-button :icon="Setting" circle></el-button>
      </template>
      
      <div class="column-setting-content">
        <div class="column-setting-header">
          <span>列设置</span>
          <el-button type="text" @click="resetColumns">重置</el-button>
        </div>
        
        <el-divider></el-divider>
        
        <div class="column-setting-body">
          <el-checkbox
            v-model="allChecked"
            :indeterminate="isIndeterminate"
            @change="handleCheckAllChange"
          >
            全选
          </el-checkbox>
          
          <div class="column-list">
            <draggable
              v-model="columnList"
              item-key="prop"
              handle=".column-drag-handle"
              @end="handleDragEnd"
            >
              <template #item="{ element }">
                <div class="column-item">
                  <el-checkbox v-model="element.visible">
                    {{ element.label }}
                  </el-checkbox>
                  <el-icon class="column-drag-handle"><DArrowUp /></el-icon>
                </div>
              </template>
            </draggable>
          </div>
        </div>
      </div>
    </el-popover>
  </div>
</template>

<script setup>
import { ref, computed, watch } from 'vue';
import { Setting, DArrowUp } from '@element-plus/icons-vue';
import draggable from 'vuedraggable';

const props = defineProps({
  columns: {
    type: Array,
    required: true
  }
});

const emit = defineEmits(['update:columns']);

// 列列表
const columnList = ref([]);

// 初始化列列表
const initColumnList = () => {
  columnList.value = props.columns.map(column => ({
    ...column,
    visible: column.visible !== false
  }));
};

// 监听列变化
watch(
  () => props.columns,
  () => {
    initColumnList();
  },
  { immediate: true, deep: true }
);

// 全选状态
const allChecked = computed({
  get: () => {
    return columnList.value.every(column => column.visible);
  },
  set: (val) => {
    columnList.value.forEach(column => {
      column.visible = val;
    });
    updateColumns();
  }
});

// 半选状态
const isIndeterminate = computed(() => {
  const visibleCount = columnList.value.filter(column => column.visible).length;
  return visibleCount > 0 && visibleCount < columnList.value.length;
});

// 处理全选变化
const handleCheckAllChange = (val) => {
  columnList.value.forEach(column => {
    column.visible = val;
  });
  updateColumns();
};

// 处理拖拽结束
const handleDragEnd = () => {
  updateColumns();
};

// 更新列
const updateColumns = () => {
  const newColumns = columnList.value.map(column => ({
    ...column
  }));
  emit('update:columns', newColumns);
};

// 重置列
const resetColumns = () => {
  initColumnList();
  updateColumns();
};

// 初始化
initColumnList();
</script>

<style scoped>
.column-setting-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
}

.column-list {
  margin-top: 10px;
  max-height: 300px;
  overflow-y: auto;
}

.column-item {
  display: flex;
  justify-content: space-between;
  align-items: center;
  padding: 5px 0;
}

.column-drag-handle {
  cursor: move;
  color: #909399;
}
</style>
```

## 高级表单组件实现

表单是中后台系统中另一个常用的组件，封装一个功能完善的表单组件可以大幅简化表单开发。

### 基础表单组件

```vue
<!-- src/components/Form/index.vue -->
<template>
  <el-form
    ref="formRef"
    :model="modelValue"
    :rules="rules"
    :label-width="labelWidth"
    :label-position="labelPosition"
    :disabled="disabled"
    :validate-on-rule-change="validateOnRuleChange"
    :size="size"
    :scroll-to-error="scrollToError"
  >
    <el-row :gutter="gutter">
      <el-col
        v-for="(item, index) in formItems"
        :key="index"
        :span="item.span || defaultSpan"
        :xs="item.xs"
        :sm="item.sm"
        :md="item.md"
        :lg="item.lg"
        :xl="item.xl"
      >
        <el-form-item
          :label="item.label"
          :prop="item.prop"
          :rules="item.rules"
          :required="item.required"
        >
          <!-- 使用具名插槽 -->
          <template v-if="$slots[item.prop]">
            <slot :name="item.prop" :item="item" :model="modelValue"></slot>
          </template>
          
          <!-- 根据类型渲染不同的表单控件 -->
          <template v-else>
            <component
              :is="getComponentByType(item.type)"
              v-model="modelValue[item.prop]"
              v-bind="getComponentProps(item)"
              @change="(val) => handleItemChange(item, val)"
            >
              <!-- 下拉选项 -->
              <template v-if="item.type === 'select'">
                <el-option
                  v-for="option in item.options"
                  :key="option.value"
                  :label="option.label"
                  :value="option.value"
                  :disabled="option.disabled"
                />
              </template>
              
              <!-- 单选选项 -->
              <template v-if="item.type === 'radio'">
                <el-
让我继续完成组件封装实践的文档内容：

```vue
<!-- src/components/Form/index.vue -->
<template>
  <el-form
    ref="formRef"
    :model="modelValue"
    :rules="rules"
    :label-width="labelWidth"
    :label-position="labelPosition"
    :disabled="disabled"
    :validate-on-rule-change="validateOnRuleChange"
    :size="size"
    :scroll-to-error="scrollToError"
  >
    <el-row :gutter="gutter">
      <el-col
        v-for="(item, index) in formItems"
        :key="index"
        :span="item.span || defaultSpan"
        :xs="item.xs"
        :sm="item.sm"
        :md="item.md"
        :lg="item.lg"
        :xl="item.xl"
      >
        <el-form-item
          :label="item.label"
          :prop="item.prop"
          :rules="item.rules"
          :required="item.required"
        >
          <!-- 使用具名插槽 -->
          <template v-if="$slots[item.prop]">
            <slot :name="item.prop" :item="item" :model="modelValue"></slot>
          </template>
          
          <!-- 根据类型渲染不同的表单控件 -->
          <template v-else>
            <component
              :is="getComponentByType(item.type)"
              v-model="modelValue[item.prop]"
              v-bind="getComponentProps(item)"
              @change="(val) => handleItemChange(item, val)"
            >
              <!-- 下拉选项 -->
              <template v-if="item.type === 'select'">
                <el-option
                  v-for="option in item.options"
                  :key="option.value"
                  :label="option.label"
                  :value="option.value"
                  :disabled="option.disabled"
                />
              </template>
              
              <!-- 单选选项 -->
              <template v-if="item.type === 'radio'">
                <el-radio
                  v-for="option in item.options"
                  :key="option.value"
                  :label="option.value"
                >
                  {{ option.label }}
                </el-radio>
              </template>
              
              <!-- 多选选项 -->
              <template v-if="item.type === 'checkbox'">
                <el-checkbox
                  v-for="option in item.options"
                  :key="option.value"
                  :label="option.value"
                >
                  {{ option.label }}
                </el-checkbox>
              </template>
            </component>
          </template>
        </el-form-item>
      </el-col>
    </el-row>
    
    <!-- 表单操作按钮 -->
    <div class="form-actions" v-if="showActions">
      <slot name="actions">
        <el-button @click="handleCancel">{{ cancelText }}</el-button>
        <el-button type="primary" @click="handleSubmit" :loading="submitLoading">{{ submitText }}</el-button>
      </slot>
    </div>
  </el-form>
</template>

<script setup>
import { ref, computed, watch, nextTick } from 'vue';
import {
  ElInput,
  ElInputNumber,
  ElSelect,
  ElOption,
  ElRadio,
  ElRadioGroup,
  ElCheckbox,
  ElCheckboxGroup,
  ElSwitch,
  ElDatePicker,
  ElTimePicker,
  ElCascader,
  ElSlider,
  ElRate,
  ElColorPicker,
  ElUpload
} from 'element-plus';

const props = defineProps({
  // 表单数据
  modelValue: {
    type: Object,
    required: true
  },
  // 表单项配置
  formItems: {
    type: Array,
    default: () => []
  },
  // 表单规则
  rules: {
    type: Object,
    default: () => ({})
  },
  // 标签宽度
  labelWidth: {
    type: [String, Number],
    default: '100px'
  },
  // 标签位置
  labelPosition: {
    type: String,
    default: 'right'
  },
  // 是否禁用
  disabled: {
    type: Boolean,
    default: false
  },
  // 栅格间隔
  gutter: {
    type: Number,
    default: 20
  },
  // 默认栅格占比
  defaultSpan: {
    type: Number,
    default: 24
  },
  // 是否在规则变化时触发验证
  validateOnRuleChange: {
    type: Boolean,
    default: true
  },
  // 组件尺寸
  size: {
    type: String,
    default: 'default'
  },
  // 是否滚动到错误位置
  scrollToError: {
    type: Boolean,
    default: true
  },
  // 是否显示操作按钮
  showActions: {
    type: Boolean,
    default: true
  },
  // 提交按钮文本
  submitText: {
    type: String,
    default: '提交'
  },
  // 取消按钮文本
  cancelText: {
    type: String,
    default: '取消'
  },
  // 提交按钮加载状态
  submitLoading: {
    type: Boolean,
    default: false
  }
});

const emit = defineEmits(['update:modelValue', 'submit', 'cancel', 'change']);

// 表单引用
const formRef = ref(null);

// 根据类型获取组件
const getComponentByType = (type) => {
  const componentMap = {
    input: ElInput,
    textarea: ElInput,
    number: ElInputNumber,
    select: ElSelect,
    radio: ElRadioGroup,
    checkbox: ElCheckboxGroup,
    switch: ElSwitch,
    date: ElDatePicker,
    time: ElTimePicker,
    datetime: ElDatePicker,
    cascader: ElCascader,
    slider: ElSlider,
    rate: ElRate,
    color: ElColorPicker,
    upload: ElUpload
  };
  
  return componentMap[type] || ElInput;
};

// 获取组件属性
const getComponentProps = (item) => {
  const { type, props = {} } = item;
  
  // 根据类型设置默认属性
  const defaultProps = {
    input: {},
    textarea: { type: 'textarea', rows: 3 },
    number: { min: 0, controlsPosition: 'right' },
    select: { placeholder: '请选择' },
    radio: {},
    checkbox: {},
    switch: {},
    date: { placeholder: '请选择日期' },
    time: { placeholder: '请选择时间' },
    datetime: { type: 'datetime', placeholder: '请选择日期时间' },
    cascader: { placeholder: '请选择' },
    slider: {},
    rate: {},
    color: {},
    upload: { action: '', autoUpload: false }
  };
  
  return { ...defaultProps[type], ...props };
};

// 处理表单项变化
const handleItemChange = (item, value) => {
  emit('change', { prop: item.prop, value });
};

// 表单验证
const validate = () => {
  return new Promise((resolve, reject) => {
    formRef.value.validate((valid, fields) => {
      if (valid) {
        resolve(true);
      } else {
        reject(fields);
      }
    });
  });
};

// 重置表单
const resetForm = () => {
  formRef.value.resetFields();
};

// 处理提交
const handleSubmit = async () => {
  try {
    await validate();
    emit('submit', { ...props.modelValue });
  } catch (error) {
    console.error('表单验证失败:', error);
  }
};

// 处理取消
const handleCancel = () => {
  emit('cancel');
};

// 暴露方法
defineExpose({
  validate,
  resetForm,
  formRef
});
</script>

<style scoped>
.form-actions {
  margin-top: 20px;
  text-align: right;
}
</style>
```

### 使用示例

```vue
<template>
  <div class="user-form">
    <my-form
      v-model="formData"
      :form-items="formItems"
      :rules="formRules"
      :submit-loading="loading"
      @submit="handleSubmit"
      @cancel="handleCancel"
    >
      <!-- 自定义头像上传 -->
      <template #avatar="{ model }">
        <el-upload
          class="avatar-uploader"
          action="/api/upload"
          :show-file-list="false"
          :on-success="handleAvatarSuccess"
          :before-upload="beforeAvatarUpload"
        >
          <img v-if="model.avatar" :src="model.avatar" class="avatar" />
          <el-icon v-else class="avatar-uploader-icon"><Plus /></el-icon>
        </el-upload>
      </template>
      
      <!-- 自定义操作按钮 -->
      <template #actions>
        <el-button @click="handleCancel">取消</el-button>
        <el-button type="primary" @click="handleSubmit" :loading="loading">保存</el-button>
        <el-button type="success" @click="handleSaveAndAdd" :loading="loading">保存并新增</el-button>
      </template>
    </my-form>
  </div>
</template>

<script setup>
import { ref, reactive } from 'vue';
import { Plus } from '@element-plus/icons-vue';
import { ElMessage } from 'element-plus';
import MyForm from '@/components/Form/index.vue';
import { createUser, updateUser } from '@/api/user';

const props = defineProps({
  isEdit: {
    type: Boolean,
    default: false
  },
  userData: {
    type: Object,
    default: () => ({})
  }
});

const emit = defineEmits(['success', 'cancel']);

// 加载状态
const loading = ref(false);

// 表单数据
const formData = reactive({
  username: '',
  nickname: '',
  password: '',
  confirmPassword: '',
  gender: 1,
  email: '',
  phone: '',
  avatar: '',
  status: 1,
  roleIds: [],
  deptId: null,
  remark: ''
});

// 初始化表单数据
if (props.isEdit && props.userData) {
  Object.assign(formData, props.userData);
  // 编辑模式下不显示密码字段
  formData.password = '';
  formData.confirmPassword = '';
}

// 表单项配置
const formItems = [
  {
    prop: 'avatar',
    label: '头像',
    span: 24
  },
  {
    prop: 'username',
    label: '用户名',
    type: 'input',
    required: true,
    span: 12,
    props: {
      placeholder: '请输入用户名'
    }
  },
  {
    prop: 'nickname',
    label: '昵称',
    type: 'input',
    span: 12,
    props: {
      placeholder: '请输入昵称'
    }
  },
  {
    prop: 'password',
    label: '密码',
    type: 'input',
    required: !props.isEdit,
    span: 12,
    props: {
      placeholder: props.isEdit ? '不填则不修改' : '请输入密码',
      showPassword: true
    },
    hidden: false // 可以根据需要隐藏
  },
  {
    prop: 'confirmPassword',
    label: '确认密码',
    type: 'input',
    required: !props.isEdit,
    span: 12,
    props: {
      placeholder: props.isEdit ? '不填则不修改' : '请再次输入密码',
      showPassword: true
    },
    hidden: false // 可以根据需要隐藏
  },
  {
    prop: 'gender',
    label: '性别',
    type: 'radio',
    span: 12,
    options: [
      { label: '男', value: 1 },
      { label: '女', value: 2 },
      { label: '未知', value: 0 }
    ]
  },
  {
    prop: 'email',
    label: '邮箱',
    type: 'input',
    span: 12,
    props: {
      placeholder: '请输入邮箱'
    }
  },
  {
    prop: 'phone',
    label: '手机号',
    type: 'input',
    span: 12,
    props: {
      placeholder: '请输入手机号'
    }
  },
  {
    prop: 'status',
    label: '状态',
    type: 'radio',
    span: 12,
    options: [
      { label: '启用', value: 1 },
      { label: '禁用', value: 0 }
    ]
  },
  {
    prop: 'roleIds',
    label: '角色',
    type: 'select',
    span: 12,
    props: {
      multiple: true,
      placeholder: '请选择角色'
    },
    options: [
      { label: '管理员', value: 1 },
      { label: '普通用户', value: 2 },
      { label: '访客', value: 3 }
    ]
  },
  {
    prop: 'deptId',
    label: '部门',
    type: 'select',
    span: 12,
    props: {
      placeholder: '请选择部门'
    },
    options: [
      { label: '总公司', value: 1 },
      { label: '研发部', value: 2 },
      { label: '市场部', value: 3 },
      { label: '财务部', value: 4 }
    ]
  },
  {
    prop: 'remark',
    label: '备注',
    type: 'textarea',
    span: 24,
    props: {
      placeholder: '请输入备注'
    }
  }
];

// 表单验证规则
const formRules = {
  username: [
    { required: true, message: '请输入用户名', trigger: 'blur' },
    { min: 3, max: 20, message: '长度在 3 到 20 个字符', trigger: 'blur' }
  ],
  password: [
    { required: !props.isEdit, message: '请输入密码', trigger: 'blur' },
    { min: 6, max: 20, message: '长度在 6 到 20 个字符', trigger: 'blur' }
  ],
  confirmPassword: [
    { required: !props.isEdit, message: '请再次输入密码', trigger: 'blur' },
    {
      validator: (rule, value, callback) => {
        if (value !== formData.password) {
          callback(new Error('两次输入密码不一致'));
        } else {
          callback();
        }
      },
      trigger: 'blur'
    }
  ],
  email: [
    { type: 'email', message: '请输入正确的邮箱地址', trigger: 'blur' }
  ],
  phone: [
    { pattern: /^1[3-9]\d{9}$/, message: '请输入正确的手机号码', trigger: 'blur' }
  ]
};

// 处理头像上传成功
const handleAvatarSuccess = (response) => {
  formData.avatar = response.data.url;
};

// 头像上传前验证
const beforeAvatarUpload = (file) => {
  const isImage = file.type.startsWith('image/');
  const isLt2M = file.size / 1024 / 1024 < 2;

  if (!isImage) {
    ElMessage.error('上传头像图片只能是图片格式!');
  }
  if (!isLt2M) {
    ElMessage.error('上传头像图片大小不能超过 2MB!');
  }
  return isImage && isLt2M;
};

// 提交表单
const handleSubmit = async () => {
  loading.value = true;
  try {
    if (props.isEdit) {
      await updateUser(props.userData.id, formData);
      ElMessage.success('修改成功');
    } else {
      await createUser(formData);
      ElMessage.success('新增成功');
    }
    emit('success');
  } catch (error) {
    console.error('提交失败:', error);
    ElMessage.error('提交失败');
  } finally {
    loading.value = false;
  }
};

// 保存并新增
const handleSaveAndAdd = async () => {
  loading.value = true;
  try {
    await createUser(formData);
    ElMessage.success('新增成功');
    // 重置表单
    Object.keys(formData).forEach(key => {
      formData[key] = '';
    });
    formData.gender = 1;
    formData.status = 1;
  } catch (error) {
    console.error('提交失败:', error);
    ElMessage.error('提交失败');
  } finally {
    loading.value = false;
  }
};

// 取消
const handleCancel = () => {
  emit('cancel');
};
</script>

<style scoped>
.avatar-uploader {
  width: 178px;
  height: 178px;
  border: 1px dashed #d9d9d9;
  border-radius: 6px;
  cursor: pointer;
  position: relative;
  overflow: hidden;
  transition: border-color 0.3s;
}

.avatar-uploader:hover {
  border-color: #409eff;
}

.avatar-uploader-icon {
  font-size: 28px;
  color: #8c939d;
  width: 178px;
  height: 178px;
  line-height: 178px;
  text-align: center;
}

.avatar {
  width: 178px;
  height: 178px;
  display: block;
}
</style>
```

### 动态表单生成器

动态表单生成器可以根据JSON配置自动生成表单，适用于需要频繁变更的表单场景。

```vue
<!-- src/components/FormGenerator/index.vue -->
<template>
  <div class="form-generator">
    <el-form
      ref="formRef"
      :model="formData"
      :rules="formRules"
      :label-width="config.labelWidth || '100px'"
      :label-position="config.labelPosition || 'right'"
      :disabled="config.disabled"
      :size="config.size || 'default'"
    >
      <el-row :gutter="config.gutter || 20">
        <template v-for="(field, index) in visibleFields" :key="field.field">
          <el-col
            :span="field.span || config.defaultSpan || 24"
            :xs="field.xs"
            :sm="field.sm"
            :md="field.md"
            :lg="field.lg"
            :xl="field.xl"
          >
            <el-form-item
              :label="field.label"
              :prop="field.field"
              :required="field.required"
            >
              <!-- 根据字段类型渲染不同的表单控件 -->
              <component
                :is="getComponentByType(field.type)"
                v-model="formData[field.field]"
                v-bind="field.props || {}"
                @change="(val) => handleFieldChange(field, val)"
              >
                <!-- 选项类控件的选项 -->
                <template v-if="['select', 'radio', 'checkbox'].includes(field.type)">
                  <component
                    :is="getOptionComponent(field.type)"
                    v-for="option in field.options"
                    :key="option.value"
                    :label="option.value"
                    :value="option.value"
                    :disabled="option.disabled"
                  >
                    {{ option.label }}
                  </component>
                </template>
              </component>
              
              <!-- 字段帮助提示 -->
              <div v-if="field.help" class="field-help">
                <el-tooltip :content="field.help" placement="top">
                  <el-icon><QuestionFilled /></el-icon>
                </el-tooltip>
              </div>
            </el-form-item>
          </el-col>
        </template>
      </el-row>
      
      <!-- 表单操作按钮 -->
      <div class="form-actions" v-if="config.showActions !== false">
        <slot name="actions">
          <el-button @click="handleCancel">{{ config.cancelText || '取消' }}</el-button>
          <el-button
            type="primary"
            @click="handleSubmit"
            :loading="submitLoading"
          >{{ config.submitText || '提交' }}</el-button>
        </slot>
      </div>
    </el-form>
  </div>
</template>

<script setup>
import { ref, reactive, computed, watch } from 'vue';
import { QuestionFilled } from '@element-plus/icons-vue';
import {
  ElInput,
  ElInputNumber,
  ElSelect,
  ElOption,
  ElRadio,
  ElRadioGroup,
  ElCheckbox,
  ElCheckboxGroup,
  ElSwitch,
  ElDatePicker,
  ElTimePicker,
  ElCascader,
  ElSlider,
  ElRate,
  ElColorPicker,
  ElUpload
} from 'element-plus';

const props = defineProps({
  // 表单配置
  config: {
    type: Object,
    required: true
  },
  // 表单数据
  modelValue: {
    type: Object,
    default: () => ({})
  },
  // 提交按钮加载状态
  submitLoading: {
    type: Boolean,
    default: false
  }
});

const emit = defineEmits(['update:modelValue', 'submit', 'cancel', 'field-change']);

// 表单引用
const formRef = ref(null);

// 表单数据
const formData = reactive({ ...props.modelValue });

// 监听表单数据变化
watch(
  () => props.modelValue,
  (newVal) => {
    Object.keys(newVal).forEach(key => {
      formData[key] = newVal[key];
    });
  },
  { deep: true }
);

// 监听表单数据变化并向上传递
watch(
  formData,
  (newVal) => {
    emit('update:modelValue', { ...newVal });
  },
  { deep: true }
);

// 表单规则
const formRules = computed(() => {
  const rules = {};
  
  props.config.fields.forEach(field => {
    if (field.rules) {
      rules[field.field] = field.rules;
    }
  });
  
  return rules;
});

// 可见字段
const visibleFields = computed(() => {
  return props.config.fields.filter(field => {
    // 处理条件显示
    if (field.visibleOn) {
      try {
        // 使用Function构造函数创建一个函数，该函数可以访问formData
        const visibleFn = new Function('formData', `return ${field.visibleOn}`);
        return visibleFn(formData);
      } catch (error) {
        console.error('字段可见性条件错误:', error);
        return true;
      }
    }
    return true;
  });
});

// 根据类型获取组件
const getComponentByType = (type) => {
  const componentMap = {
    input: ElInput,
    textarea: ElInput,
    number: ElInputNumber,
    select: ElSelect,
    radio: ElRadioGroup,
    checkbox: ElCheckboxGroup,
    switch: ElSwitch,
    date: ElDatePicker,
    time: ElTimePicker,
    datetime: ElDatePicker,
    cascader: ElCascader,
    slider: ElSlider,
    rate: ElRate,
    color: ElColorPicker,
    upload: ElUpload
  };
  
  return componentMap[type] || ElInput;
};

// 获取选项组件
const getOptionComponent = (type) => {
  const componentMap = {
    select: ElOption,
    radio: ElRadio,
    checkbox: ElCheckbox
  };
  
  return componentMap[type] || ElOption;
};

// 处理字段变化
const handleFieldChange = (field, value) => {
  emit('field-change', { field: field.field, value });
};

// 表单验证
const validate = () => {
  return new Promise((resolve, reject) => {
    formRef.value.validate((valid, fields) => {
      if (valid) {
        resolve(true);
      } else {
        reject(fields);
      }
    });
  });
};

// 重置表单
const resetForm = () => {
  formRef.value.resetFields();
};

// 处理提交
const handleSubmit = async () => {
  try {
    await validate();
    emit('submit', { ...formData });
  } catch (error) {
    console.error('表单验证失败:', error);
  }
};

// 处理取消
const handleCancel = () => {
  emit('cancel');
};

// 暴露方法
defineExpose({
  validate,
  resetForm,
  formRef
});
</script>

<style scoped>
.form-actions {
  margin-top: 20px;
  text-align: right;
}

.field-help {
  display: inline-block;
  margin-left: 5px;
  color: #909399;
  cursor: pointer;
}
</style>
```

### 使用示例

```vue
<template>
  <div class="dynamic-form-demo">
    <form-generator
      v-model="formData"
      :config="formConfig"
      :submit-loading="loading"
      @submit="handleSubmit"
      @cancel="handleCancel"
      @field-change="handleFieldChange"
    />
  </div>
</template>

<script setup>
import { ref, reactive } from 'vue';
import { ElMessage } from 'element-plus';
import FormGenerator from '@/components/FormGenerator/index.vue';

// 表单数据
const formData = reactive({
  name: '',
  type: 'personal',
  idType: 'id_card',
  idNumber: '',
  gender: 1,
  birthday: '',
  address: '',
  province: '',
  city: '',
  district: '',
  companyName: '',
  taxNumber: '',
  contactPerson: '',
  contactPhone: '',
  agreeTerms: false
});

// 表单配置
const formConfig = {
  labelWidth: '120px',
  defaultSpan: 12,
  fields: [
    {
      field: 'name',
      label: '姓名/企业名称',
      type: 'input',
      required: true,
      span: 12,
      rules: [
        { required: true, message: '请输入姓名/企业名称', trigger: 'blur' }
      ]
    },
    {
      field: 'type',
      label: '客户类型',
      type: 'radio',
      required: true,
      span: 24,
      options: [
        { label: '个人', value: 'personal' },
        { label: '企业', value: 'company' }
      ]
    },
    {
      field: 'idType',
      label: '证件类型',
      type: 'select',
      required: true,
      span: 12,
      visibleOn: 'formData.type === "personal"',
      options: [
        { label: '身份证', value: 'id_card' },
        { label: '护照', value: 'passport' },
        { label: '军官证', value: 'military_id' }
      ],
      props: {
        placeholder: '请选择证件类型'
      }
    },
    {
      field: 'idNumber',
      label: '证件号码',
      type: 'input',
      required: true,
      span: 12,
      visibleOn: 'formData.type === "personal"',
      rules: [
        { required: true, message: '请输入证件号码', trigger: 'blur' }
      ],
      props: {
        placeholder: '请输入证件号码'
      }
    },
    {
      field: 'gender',
      label: '性别',
      type: 'radio',
      span: 12,
      visibleOn: 'formData.type === "personal"',
      options: [
        { label: '男', value: 1 },
        { label: '女', value: 2 }
      ]
    },
    {
      field: 'birthday',
      label: '出生日期',
      type: 'date',
      span: 12,
      visibleOn: 'formData.type === "personal"',
      props: {
        placeholder: '请选择出生日期',
        valueFormat: 'YYYY-MM-DD'
      }
    },
    {
      field: 'companyName',
      label: '企业名称',
      type: 'input',
      required: true,
      span: 12,
      visibleOn: 'formData.type === "company"',
      rules: [
        { required: true, message: '请输入企业名称', trigger: 'blur' }
      ],
      props: {
        placeholder: '请输入企业名称'
      }
    },
    {
      field: 'taxNumber',
      label: '税号',
      type: 'input',
      required: true,
      span: 12,
      visibleOn: 'formData.type === "company"',
      rules: [
        { required: true, message: '请输入税号', trigger: 'blur' }
      ],
      props: {
        placeholder: '请输入税号'
      }
    },
    {
      field: 'contactPerson',
让我继续完成组件封装实践的文档内容：

```vue
<template>
  <div class="dynamic-form-demo">
    <form-generator
      v-model="formData"
      :config="formConfig"
      :submit-loading="loading"
      @submit="handleSubmit"
      @cancel="handleCancel"
      @field-change="handleFieldChange"
    />
  </div>
</template>

<script setup>
import { ref, reactive } from 'vue';
import { ElMessage } from 'element-plus';
import FormGenerator from '@/components/FormGenerator/index.vue';

// 表单数据
const formData = reactive({
  name: '',
  type: 'personal',
  idType: 'id_card',
  idNumber: '',
  gender: 1,
  birthday: '',
  address: '',
  province: '',
  city: '',
  district: '',
  companyName: '',
  taxNumber: '',
  contactPerson: '',
  contactPhone: '',
  agreeTerms: false
});

// 表单配置
const formConfig = {
  labelWidth: '120px',
  defaultSpan: 12,
  fields: [
    {
      field: 'name',
      label: '姓名/企业名称',
      type: 'input',
      required: true,
      span: 12,
      rules: [
        { required: true, message: '请输入姓名/企业名称', trigger: 'blur' }
      ]
    },
    {
      field: 'type',
      label: '客户类型',
      type: 'radio',
      required: true,
      span: 24,
      options: [
        { label: '个人', value: 'personal' },
        { label: '企业', value: 'company' }
      ]
    },
    {
      field: 'idType',
      label: '证件类型',
      type: 'select',
      required: true,
      span: 12,
      visibleOn: 'formData.type === "personal"',
      options: [
        { label: '身份证', value: 'id_card' },
        { label: '护照', value: 'passport' },
        { label: '军官证', value: 'military_id' }
      ],
      props: {
        placeholder: '请选择证件类型'
      }
    },
    {
      field: 'idNumber',
      label: '证件号码',
      type: 'input',
      required: true,
      span: 12,
      visibleOn: 'formData.type === "personal"',
      rules: [
        { required: true, message: '请输入证件号码', trigger: 'blur' }
      ],
      props: {
        placeholder: '请输入证件号码'
      }
    },
    {
      field: 'gender',
      label: '性别',
      type: 'radio',
      span: 12,
      visibleOn: 'formData.type === "personal"',
      options: [
        { label: '男', value: 1 },
        { label: '女', value: 2 }
      ]
    },
    {
      field: 'birthday',
      label: '出生日期',
      type: 'date',
      span: 12,
      visibleOn: 'formData.type === "personal"',
      props: {
        placeholder: '请选择出生日期',
        valueFormat: 'YYYY-MM-DD'
      }
    },
    {
      field: 'companyName',
      label: '企业名称',
      type: 'input',
      required: true,
      span: 12,
      visibleOn: 'formData.type === "company"',
      rules: [
        { required: true, message: '请输入企业名称', trigger: 'blur' }
      ],
      props: {
        placeholder: '请输入企业名称'
      }
    },
    {
      field: 'taxNumber',
      label: '税号',
      type: 'input',
      required: true,
      span: 12,
      visibleOn: 'formData.type === "company"',
      rules: [
        { required: true, message: '请输入税号', trigger: 'blur' }
      ],
      props: {
        placeholder: '请输入税号'
      }
    },
    {
      field: 'contactPerson',
      label: '联系人',
      type: 'input',
      required: true,
      span: 12,
      visibleOn: 'formData.type === "company"',
      rules: [
        { required: true, message: '请输入联系人', trigger: 'blur' }
      ],
      props: {
        placeholder: '请输入联系人'
      }
    },
    {
      field: 'contactPhone',
      label: '联系电话',
      type: 'input',
      required: true,
      span: 12,
      visibleOn: 'formData.type === "company"',
      rules: [
        { required: true, message: '请输入联系电话', trigger: 'blur' },
        { pattern: /^1[3-9]\d{9}$/, message: '请输入正确的手机号码', trigger: 'blur' }
      ],
      props: {
        placeholder: '请输入联系电话'
      }
    },
    {
      field: 'address',
      label: '详细地址',
      type: 'textarea',
      span: 24,
      props: {
        placeholder: '请输入详细地址',
        rows: 3
      }
    },
    {
      field: 'agreeTerms',
      label: '同意条款',
      type: 'switch',
      span: 24,
      required: true,
      rules: [
        { 
          validator: (rule, value, callback) => {
            if (!value) {
              callback(new Error('请同意条款'));
            } else {
              callback();
            }
          }, 
          trigger: 'change' 
        }
      ]
    }
  ]
};

// 加载状态
const loading = ref(false);

// 处理字段变化
const handleFieldChange = ({ field, value }) => {
  console.log('字段变化:', field, value);
  
  // 根据字段变化执行特定逻辑
  if (field === 'type') {
    // 客户类型变化时重置相关字段
    if (value === 'personal') {
      formData.companyName = '';
      formData.taxNumber = '';
      formData.contactPerson = '';
      formData.contactPhone = '';
    } else {
      formData.idType = '';
      formData.idNumber = '';
      formData.gender = 1;
      formData.birthday = '';
    }
  }
};

// 提交表单
const handleSubmit = async (data) => {
  loading.value = true;
  try {
    // 模拟API请求
    await new Promise(resolve => setTimeout(resolve, 1000));
    console.log('提交数据:', data);
    ElMessage.success('提交成功');
  } catch (error) {
    console.error('提交失败:', error);
    ElMessage.error('提交失败');
  } finally {
    loading.value = false;
  }
};

// 取消
const handleCancel = () => {
  ElMessage.info('已取消');
};
</script>
```

## 权限按钮组件

权限按钮组件是中后台系统中常用的组件，用于根据用户权限动态显示或隐藏按钮。

### 基础权限按钮组件

```vue
<!-- src/components/PermissionButton/index.vue -->
<template>
  <el-button
    v-if="hasPermission"
    v-bind="$attrs"
    :type="type"
    :size="size"
    :icon="icon"
    :loading="loading"
    :disabled="disabled"
    @click="handleClick"
  >
    <slot>{{ text }}</slot>
  </el-button>
</template>

<script setup>
import { computed } from 'vue';
import { usePermissionStore } from '@/stores/permission';

const props = defineProps({
  // 按钮类型
  type: {
    type: String,
    default: 'default'
  },
  // 按钮大小
  size: {
    type: String,
    default: 'default'
  },
  // 按钮图标
  icon: {
    type: [String, Object],
    default: null
  },
  // 按钮文本
  text: {
    type: String,
    default: ''
  },
  // 加载状态
  loading: {
    type: Boolean,
    default: false
  },
  // 禁用状态
  disabled: {
    type: Boolean,
    default: false
  },
  // 权限标识，支持多个权限（满足任一权限即可）
  permission: {
    type: [String, Array],
    default: null
  },
  // 权限模式：and(都满足)、or(满足任一)
  permissionMode: {
    type: String,
    default: 'or'
  }
});

const emit = defineEmits(['click']);

// 权限验证
const permissionStore = usePermissionStore();

// 判断是否有权限
const hasPermission = computed(() => {
  // 如果没有设置权限标识，则默认有权限
  if (!props.permission) return true;
  
  // 将权限标识转换为数组
  const permissions = Array.isArray(props.permission)
    ? props.permission
    : [props.permission];
  
  // 如果权限数组为空，则默认有权限
  if (permissions.length === 0) return true;
  
  // 根据权限模式判断
  if (props.permissionMode === 'and') {
    // 必须满足所有权限
    return permissions.every(permission => 
      permissionStore.hasPermission(permission)
    );
  } else {
    // 满足任一权限即可
    return permissions.some(permission => 
      permissionStore.hasPermission(permission)
    );
  }
});

// 点击事件处理
const handleClick = (event) => {
  emit('click', event);
};
</script>
```

### 使用示例

```vue
<template>
  <div class="permission-button-demo">
    <!-- 基础用法 -->
    <permission-button
      permission="system:user:add"
      type="primary"
      @click="handleAdd"
    >
      新增用户
    </permission-button>
    
    <!-- 多权限模式（满足任一权限） -->
    <permission-button
      :permission="['system:user:edit', 'system:user:update']"
      type="warning"
      @click="handleEdit"
    >
      编辑用户
    </permission-button>
    
    <!-- 多权限模式（必须满足所有权限） -->
    <permission-button
      :permission="['system:user:delete', 'system:admin']"
      permission-mode="and"
      type="danger"
      @click="handleDelete"
    >
      删除用户
    </permission-button>
    
    <!-- 使用图标 -->
    <permission-button
      permission="system:user:export"
      type="success"
      :icon="Download"
      @click="handleExport"
    >
      导出用户
    </permission-button>
  </div>
</template>

<script setup>
import { Download } from '@element-plus/icons-vue';
import { ElMessage } from 'element-plus';
import PermissionButton from '@/components/PermissionButton/index.vue';

// 新增用户
const handleAdd = () => {
  ElMessage.success('新增用户');
};

// 编辑用户
const handleEdit = () => {
  ElMessage.warning('编辑用户');
};

// 删除用户
const handleDelete = () => {
  ElMessage.error('删除用户');
};

// 导出用户
const handleExport = () => {
  ElMessage.success('导出用户');
};
</script>

<style scoped>
.permission-button-demo {
  display: flex;
  gap: 10px;
}
</style>
```

## 图表组件封装

图表是中后台系统中常用的数据可视化组件，封装一个功能完善的图表组件可以大幅提高开发效率。

### 基础图表组件

```vue
<!-- src/components/Chart/index.vue -->
<template>
  <div
    ref="chartRef"
    :style="{
      width: width,
      height: height
    }"
    class="chart-container"
  ></div>
</template>

<script setup>
import { ref, onMounted, onBeforeUnmount, watch } from 'vue';
import * as echarts from 'echarts';
import { debounce } from 'lodash-es';

const props = defineProps({
  // 图表选项
  options: {
    type: Object,
    required: true
  },
  // 图表宽度
  width: {
    type: String,
    default: '100%'
  },
  // 图表高度
  height: {
    type: String,
    default: '300px'
  },
  // 是否自动调整大小
  autoResize: {
    type: Boolean,
    default: true
  },
  // 主题
  theme: {
    type: String,
    default: ''
  }
});

const emit = defineEmits(['chartReady', 'chartClick', 'chartDataZoom']);

// 图表DOM引用
const chartRef = ref(null);
// 图表实例
let chartInstance = null;

// 初始化图表
const initChart = () => {
  if (!chartRef.value) return;
  
  // 销毁旧实例
  if (chartInstance) {
    chartInstance.dispose();
  }
  
  // 创建新实例
  chartInstance = echarts.init(chartRef.value, props.theme);
  
  // 设置选项
  if (props.options) {
    chartInstance.setOption(props.options);
  }
  
  // 绑定事件
  chartInstance.on('click', (params) => {
    emit('chartClick', params);
  });
  
  chartInstance.on('datazoom', (params) => {
    emit('chartDataZoom', params);
  });
  
  // 通知图表已准备好
  emit('chartReady', chartInstance);
};

// 调整图表大小
const resizeChart = debounce(() => {
  if (chartInstance) {
    chartInstance.resize();
  }
}, 100);

// 监听选项变化
watch(
  () => props.options,
  (newOptions) => {
    if (chartInstance) {
      chartInstance.setOption(newOptions);
    }
  },
  { deep: true }
);

// 监听主题变化
watch(
  () => props.theme,
  () => {
    initChart();
  }
);

// 组件挂载后初始化图表
onMounted(() => {
  initChart();
  
  // 添加窗口大小变化监听
  if (props.autoResize) {
    window.addEventListener('resize', resizeChart);
  }
});

// 组件卸载前清理
onBeforeUnmount(() => {
  if (chartInstance) {
    chartInstance.dispose();
    chartInstance = null;
  }
  
  // 移除窗口大小变化监听
  if (props.autoResize) {
    window.removeEventListener('resize', resizeChart);
  }
});

// 暴露方法
defineExpose({
  // 获取图表实例
  getChartInstance: () => chartInstance,
  // 手动调整大小
  resize: resizeChart
});
</script>

<style scoped>
.chart-container {
  position: relative;
}
</style>
```

### 使用示例

```vue
<template>
  <div class="chart-demo">
    <el-card>
      <template #header>
        <div class="card-header">
          <span>销售数据分析</span>
          <div class="chart-actions">
            <el-radio-group v-model="chartType" size="small">
              <el-radio-button label="bar">柱状图</el-radio-button>
              <el-radio-button label="line">折线图</el-radio-button>
              <el-radio-button label="pie">饼图</el-radio-button>
            </el-radio-group>
          </div>
        </div>
      </template>
      
      <my-chart
        :options="chartOptions"
        height="400px"
        @chart-click="handleChartClick"
      />
    </el-card>
  </div>
</template>

<script setup>
import { ref, computed, onMounted } from 'vue';
import { ElMessage } from 'element-plus';
import MyChart from '@/components/Chart/index.vue';

// 图表类型
const chartType = ref('bar');

// 图表数据
const chartData = ref({
  categories: ['一月', '二月', '三月', '四月', '五月', '六月'],
  series: [
    {
      name: '销售额',
      data: [10000, 15000, 12000, 18000, 20000, 25000]
    },
    {
      name: '成本',
      data: [6000, 9000, 7500, 11000, 12000, 15000]
    },
    {
      name: '利润',
      data: [4000, 6000, 4500, 7000, 8000, 10000]
    }
  ]
});

// 图表选项
const chartOptions = computed(() => {
  const { categories, series } = chartData.value;
  
  // 基础配置
  const baseOptions = {
    tooltip: {
      trigger: 'axis',
      axisPointer: {
        type: 'shadow'
      }
    },
    legend: {
      data: series.map(item => item.name)
    },
    grid: {
      left: '3%',
      right: '4%',
      bottom: '3%',
      containLabel: true
    }
  };
  
  // 根据图表类型生成不同的选项
  if (chartType.value === 'bar') {
    return {
      ...baseOptions,
      xAxis: {
        type: 'category',
        data: categories
      },
      yAxis: {
        type: 'value'
      },
      series: series.map(item => ({
        name: item.name,
        type: 'bar',
        data: item.data
      }))
    };
  } else if (chartType.value === 'line') {
    return {
      ...baseOptions,
      xAxis: {
        type: 'category',
        data: categories
      },
      yAxis: {
        type: 'value'
      },
      series: series.map(item => ({
        name: item.name,
        type: 'line',
        smooth: true,
        data: item.data
      }))
    };
  } else if (chartType.value === 'pie') {
    // 计算总销售额
    const totalSales = series[0].data.reduce((sum, val) => sum + val, 0);
    
    // 生成饼图数据
    const pieData = categories.map((category, index) => ({
      name: category,
      value: series[0].data[index]
    }));
    
    return {
      ...baseOptions,
      tooltip: {
        trigger: 'item',
        formatter: '{a} <br/>{b}: {c} ({d}%)'
      },
      series: [
        {
          name: '销售额',
          type: 'pie',
          radius: ['40%', '70%'],
          avoidLabelOverlap: false,
          itemStyle: {
            borderRadius: 10,
            borderColor: '#fff',
            borderWidth: 2
          },
          label: {
            show: true,
            formatter: '{b}: {c} ({d}%)'
          },
          emphasis: {
            label: {
              show: true,
              fontSize: '14',
              fontWeight: 'bold'
            }
          },
          data: pieData
        }
      ]
    };
  }
  
  return baseOptions;
});

// 处理图表点击
const handleChartClick = (params) => {
  const { seriesName, name, value } = params;
  ElMessage.info(`点击了 ${name} 的 ${seriesName}，值为 ${value}`);
};

// 获取图表数据
const fetchChartData = async () => {
  try {
    // 模拟API请求
    await new Promise(resolve => setTimeout(resolve, 500));
    
    // 实际项目中应该从API获取数据
    chartData.value = {
      categories: ['一月', '二月', '三月', '四月', '五月', '六月'],
      series: [
        {
          name: '销售额',
          data: [10000, 15000, 12000, 18000, 20000, 25000]
        },
        {
          name: '成本',
          data: [6000, 9000, 7500, 11000, 12000, 15000]
        },
        {
          name: '利润',
          data: [4000, 6000, 4500, 7000, 8000, 10000]
        }
      ]
    };
  } catch (error) {
    console.error('获取图表数据失败:', error);
    ElMessage.error('获取图表数据失败');
  }
};

// 初始化
onMounted(() => {
  fetchChartData();
});
</script>

<style scoped>
.card-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
}

.chart-actions {
  display: flex;
  gap: 10px;
}
</style>
```

## 主题定制与样式隔离

在组件封装中，主题定制和样式隔离是重要的考虑因素，可以提高组件的可复用性和可维护性。

### CSS变量实现主题定制

```scss
// src/styles/variables.scss

// 主题色变量
:root {
  // 主色
  --primary-color: #409eff;
  --primary-light-color: #ecf5ff;
  --primary-dark-color: #337ecc;
  
  // 辅助色
  --success-color: #67c23a;
  --warning-color: #e6a23c;
  --danger-color: #f56c6c;
  --info-color: #909399;
  
  // 文字颜色
  --text-primary-color: #303133;
  --text-regular-color: #606266;
  --text-secondary-color: #909399;
  --text-placeholder-color: #c0c4cc;
  
  // 边框颜色
  --border-color-base: #dcdfe6;
  --border-color-light: #e4e7ed;
  --border-color-lighter: #ebeef5;
  --border-color-extra-light: #f2f6fc;
  
  // 背景颜色
  --background-color-base: #f5f7fa;
  --background-color-light: #f5f7fa;
  
  // 字体大小
  --font-size-extra-large: 20px;
  --font-size-large: 18px;
  --font-size-medium: 16px;
  --font-size-base: 14px;
  --font-size-small: 13px;
  --font-size-extra-small: 12px;
  
  // 边框圆角
  --border-radius-base: 4px;
  --border-radius-small: 2px;
  --border-radius-round: 20px;
  --border-radius-circle: 100%;
  
  // 阴影
  --box-shadow-base: 0 2px 4px rgba(0, 0, 0, 0.12), 0 0 6px rgba(0, 0, 0, 0.04);
  --box-shadow-light: 0 2px 12px 0 rgba(0, 0, 0, 0.1);
  
  // 过渡
  --transition-duration: 0.3s;
}

// 暗黑主题
.dark-theme {
  // 主色
  --primary-color: #409eff;
  --primary-light-color: #18222c;
  --primary-dark-color: #337ecc;
  
  // 辅助色
  --success-color: #67c23a;
  --warning-color: #e6a23c;
  --danger-color: #f56c6c;
  --info-color: #909399;
  
  // 文字颜色
  --text-primary-color: #e5eaf3;
  --text-regular-color: #cfd3dc;
  --text-secondary-color: #a3a6ad;
  --text-placeholder-color: #8d9095;
  
  // 边框颜色
  --border-color-base: #4c4d4f;
  --border-color-light: #363637;
  --border-color-lighter: #2b2b2c;
  --border-color-extra-light: #212122;
  
  // 背景颜色
  --background-color-base: #141414;
  --background-color-light: #1d1e1f;
}
```

### 组件中使用CSS变量

```vue
<!-- src/components/Button/index.vue -->
<template>
  <button
    class="custom-button"
    :class="[
      `custom-button--${type}`,
      `custom-button--${size}`,
      {
        'is-disabled': disabled,
        'is-loading': loading,
        'is-round': round,
        'is-circle': circle
      }
    ]"
    :disabled="disabled || loading"
    @click="handleClick"
  >
    <i v-if="loading" class="custom-button__loading"></i>
    <i v-if="icon && !loading" class="custom-button__icon" :class="icon"></i>
    <span v-if="$slots.default" class="custom-button__text">
      <slot></slot>
    </span>
  </button>
</template>

<script setup>
import { defineProps, defineEmits } from 'vue';

const props = defineProps({
  type: {
    type: String,
    default: 'default'
  },
  size: {
    type: String,
    default: 'medium'
  },
  icon: {
    type: String,
    default: ''
  },
  loading: {
    type: Boolean,
    default: false
  },
  disabled: {
    type: Boolean,
    default: false
  },
  round: {
    type: Boolean,
    default: false
  },
  circle: {
    type: Boolean,
    default: false
  }
});

const emit = defineEmits(['click']);

const handleClick = (event) => {
  if (props.disabled || props.loading) return;
  emit('click', event);
};
</script>

<style scoped>
.custom-button {
  display: inline-flex;
  justify-content: center;
  align-items: center;
  line-height: 1;
  white-space: nowrap;
  cursor: pointer;
  background: var(--background-color-base);
  border: 1px solid var(--border-color-base);
  color: var(--text-regular-color);
  text-align: center;
  box-sizing: border-box;
  outline: none;
  transition: all var(--transition-duration);
  padding: 8px 15px;
  font-size: var(--font-size-base);
  border-radius: var(--border-radius-base);
  font-weight: 500;
}

.custom-button:hover,
.custom-button:focus {
  color: var(--primary-color);
  border-color: var(--primary-color);
  background-color: var(--primary-light-color);
}

.custom-button--primary {
  color: #fff;
  background-color: var(--primary-color);
  border-color: var(--primary-color);
}

.custom-button--primary:hover,
.custom-button--primary:focus {
  background-color: var(--primary-dark-color);
  border-color: var(--primary-dark-color);
  color: #fff;
}

.custom-button--success {
  color: #fff;
  background-color: var(--success-color);
  border-color: var(--success-color);
}

.custom-button--warning {
  color: #fff;
  background-color: var(--warning-color);
  border-color: var(--warning-color);
}

.custom-button--danger {
  color: #fff;
  background-color: var(--danger-color);
  border-color: var(--danger-color);
}

.custom-button--info {
  color: #fff;
  background-color: var(--info-color);
  border-color: var(--info-color);
}

.custom-button--large {
  padding: 12px 19px;
  font-size: var(--font-size-large);
  border-radius: var(--border-radius-base);
}

.custom-button--small {
  padding: 5px 11px;
  font-size: var(--font-size-small);
  border-radius: var(--border-radius-base);
}

.custom-button--mini {
  padding: 4px 7px;
  font-size: var(--font-size-extra-small);
  border-radius: var(--border-radius-small);
}

.custom-button.is-disabled,
.custom-button.is-disabled:hover,
.custom-button.is-disabled:focus {
  color: var(--text-placeholder-color);
  cursor: not-allowed;
  background-image: none;
  background-color: var(--background-color-light);
  border-color: var(--border-color-lighter);
}

.custom-button.is-loading {
  position: relative;
  pointer-events: none;
}

.custom-button__loading {
  display: inline-block;
  width: 14px;
  height: 14px;
让我继续完成组件封装实践的文档内容：

```css
.custom-button__loading {
  display: inline-block;
  width: 14px;
  height: 14px;
  border: 2px solid var(--border-color-light);
  border-radius: 50%;
  border-top-color: var(--text-regular-color);
  animation: button-loading-spin 1s linear infinite;
  margin-right: 5px;
}

@keyframes button-loading-spin {
  0% {
    transform: rotate(0deg);
  }
  100% {
    transform: rotate(360deg);
  }
}

.custom-button__icon {
  margin-right: 5px;
}

.custom-button__text {
  line-height: 1;
}

.custom-button.is-round {
  border-radius: var(--border-radius-round);
}

.custom-button.is-circle {
  border-radius: var(--border-radius-circle);
  padding: 8px;
}
</style>
```

### 样式隔离方案

在组件封装中，样式隔离是避免样式冲突的重要手段。以下是几种常用的样式隔离方案：

#### 1. CSS Modules

CSS Modules 是一种在构建时将类名转换为唯一标识符的技术，可以有效避免样式冲突。

```vue
<template>
  <div :class="$style.container">
    <h2 :class="$style.title">{{ title }}</h2>
    <div :class="$style.content">
      <slot></slot>
    </div>
  </div>
</template>

<script setup>
defineProps({
  title: {
    type: String,
    default: ''
  }
});
</script>

<style module>
.container {
  border: 1px solid var(--border-color-base);
  border-radius: var(--border-radius-base);
  padding: 16px;
  margin-bottom: 16px;
}

.title {
  font-size: var(--font-size-large);
  color: var(--text-primary-color);
  margin-top: 0;
  margin-bottom: 16px;
}

.content {
  color: var(--text-regular-color);
}
</style>
```

#### 2. Scoped CSS

Vue 提供的 scoped 属性可以将样式限制在当前组件内，通过添加唯一的属性选择器实现样式隔离。

```vue
<template>
  <div class="card">
    <div class="card-header">
      <slot name="header">{{ title }}</slot>
    </div>
    <div class="card-body">
      <slot></slot>
    </div>
    <div v-if="$slots.footer" class="card-footer">
      <slot name="footer"></slot>
    </div>
  </div>
</template>

<script setup>
defineProps({
  title: {
    type: String,
    default: ''
  }
});
</script>

<style scoped>
.card {
  border: 1px solid var(--border-color-base);
  border-radius: var(--border-radius-base);
  margin-bottom: 16px;
  background-color: #fff;
  box-shadow: var(--box-shadow-light);
  transition: all var(--transition-duration);
}

.card:hover {
  box-shadow: var(--box-shadow-base);
}

.card-header {
  padding: 12px 16px;
  border-bottom: 1px solid var(--border-color-lighter);
  font-size: var(--font-size-medium);
  font-weight: bold;
  color: var(--text-primary-color);
}

.card-body {
  padding: 16px;
}

.card-footer {
  padding: 12px 16px;
  border-top: 1px solid var(--border-color-lighter);
  background-color: var(--background-color-light);
}
</style>
```

#### 3. CSS-in-JS

使用 CSS-in-JS 库（如 styled-components）可以在 JavaScript 中编写样式，并自动生成唯一的类名。

```vue
<template>
  <div>
    <styled-button
      :type="type"
      :size="size"
      :disabled="disabled"
      @click="handleClick"
    >
      <slot></slot>
    </styled-button>
  </div>
</template>

<script setup>
import { styled } from 'vue3-styled-components';

const props = defineProps({
  type: {
    type: String,
    default: 'default'
  },
  size: {
    type: String,
    default: 'medium'
  },
  disabled: {
    type: Boolean,
    default: false
  }
});

const emit = defineEmits(['click']);

const handleClick = (event) => {
  if (!props.disabled) {
    emit('click', event);
  }
};

// 使用 styled-components 创建样式化组件
const StyledButton = styled('button', {
  type: String,
  size: String,
  disabled: Boolean
})`
  display: inline-flex;
  justify-content: center;
  align-items: center;
  line-height: 1;
  white-space: nowrap;
  cursor: ${props => props.disabled ? 'not-allowed' : 'pointer'};
  background: ${props => props.type === 'primary' ? 'var(--primary-color)' : 'var(--background-color-base)'};
  border: 1px solid ${props => props.type === 'primary' ? 'var(--primary-color)' : 'var(--border-color-base)'};
  color: ${props => props.type === 'primary' ? '#fff' : 'var(--text-regular-color)'};
  text-align: center;
  box-sizing: border-box;
  outline: none;
  transition: all var(--transition-duration);
  opacity: ${props => props.disabled ? 0.7 : 1};
  
  /* 尺寸 */
  padding: ${props => {
    switch (props.size) {
      case 'large': return '12px 19px';
      case 'small': return '5px 11px';
      default: return '8px 15px';
    }
  }};
  
  font-size: ${props => {
    switch (props.size) {
      case 'large': return 'var(--font-size-large)';
      case 'small': return 'var(--font-size-small)';
      default: return 'var(--font-size-base)';
    }
  }};
  
  border-radius: var(--border-radius-base);
  
  &:hover, &:focus {
    color: ${props => props.type === 'primary' ? '#fff' : 'var(--primary-color)'};
    border-color: ${props => props.type === 'primary' ? 'var(--primary-dark-color)' : 'var(--primary-color)'};
    background-color: ${props => props.type === 'primary' ? 'var(--primary-dark-color)' : 'var(--primary-light-color)'};
  }
`;
</script>
```

## 总结

组件封装是前端开发中的重要环节，良好的组件封装可以提高开发效率、代码复用性和系统可维护性。本文档详细介绍了中后台系统中常见组件的封装思路和实践经验，包括：

1. **业务组件设计原则**：单一职责、可配置性、组合优于继承、接口一致性、可测试性和文档完善等原则。

2. **通用表格组件封装**：实现了功能完善的表格组件，支持自定义列、排序、筛选、分页、拖拽排序和列设置等功能。

3. **高级表单组件实现**：封装了灵活的表单组件，支持各种表单控件、表单验证、动态表单等功能。

4. **权限按钮组件**：根据用户权限动态显示或隐藏按钮，支持多权限模式。

5. **图表组件封装**：基于 ECharts 封装的图表组件，支持自动调整大小、主题切换等功能。

6. **主题定制与样式隔离**：通过 CSS 变量实现主题定制，使用 CSS Modules、Scoped CSS 和 CSS-in-JS 等技术实现样式隔离。

在实际开发中，应根据项目需求和团队技术栈选择合适的组件封装方案，遵循组件设计原则，编写高质量的组件代码，提高开发效率和代码质量。