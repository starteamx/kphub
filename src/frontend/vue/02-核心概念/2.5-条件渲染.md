我将为您编写一份关于Vue条件渲染的详细文档，适合不同级别的开发者阅读。

```markdown:c:\project\kphub\src\frontend\vue\02-基础\2.5-条件渲染.md
---
title: 条件渲染
icon: condition
order: 5
---

# 条件渲染

条件渲染允许我们根据不同的条件显示不同的内容。本文将介绍Vue中的条件渲染指令，包括v-if、v-else、v-else-if、v-show等内容，帮助读者理解不同条件渲染方式的区别和适用场景。

## 什么是条件渲染？

在Web应用开发中，我们经常需要根据不同的状态或条件来决定是否显示某些元素。例如：

- 根据用户是否登录显示不同的导航菜单
- 根据数据加载状态显示加载中、成功或错误提示
- 根据用户权限显示或隐藏某些功能按钮
- 根据表单验证结果显示错误信息

传统的JavaScript方式需要手动操作DOM来实现这些功能，代码繁琐且容易出错：

```javascript
// 传统DOM操作
if (isLoggedIn) {
  document.getElementById('userMenu').style.display = 'block';
  document.getElementById('loginButton').style.display = 'none';
} else {
  document.getElementById('userMenu').style.display = 'none';
  document.getElementById('loginButton').style.display = 'block';
}
```

Vue提供了声明式的条件渲染指令，使这些操作变得简单而直观：

```vue
<div id="userMenu" v-if="isLoggedIn">用户菜单</div>
<button id="loginButton" v-if="!isLoggedIn">登录</button>
```

## v-if 指令

`v-if` 是最常用的条件渲染指令，它根据表达式的真假值来决定是否渲染元素：

```vue
<template>
  <div>
    <h2 v-if="isVisible">这段内容会根据条件显示或隐藏</h2>
    <button @click="toggleVisibility">切换显示状态</button>
  </div>
</template>

<script setup>
import { ref } from 'vue';

const isVisible = ref(true);

function toggleVisibility() {
  isVisible.value = !isVisible.value;
}
</script>
```

### v-if 的工作原理

当 `v-if` 的条件为真时，元素会被渲染到DOM中；当条件为假时，元素会被完全移除出DOM。这意味着：

1. 元素及其所有子元素会被销毁和重建
2. 元素上绑定的事件监听器会被移除和重新添加
3. 组件实例会被销毁和重新创建

这种"真实的"条件渲染确保了当条件为假时，不会有不必要的元素存在于DOM中，有助于减少内存占用和提高性能。

### 在 `<template>` 元素上使用 v-if

如果需要切换多个元素的显示状态，但不想引入额外的包装元素，可以在 `<template>` 元素上使用 `v-if`：

```vue
<template>
  <div>
    <template v-if="showUserInfo">
      <h3>用户信息</h3>
      <p>姓名: {{ user.name }}</p>
      <p>邮箱: {{ user.email }}</p>
      <p>角色: {{ user.role }}</p>
    </template>
    <button @click="showUserInfo = !showUserInfo">
      {{ showUserInfo ? '隐藏' : '显示' }}用户信息
    </button>
  </div>
</template>

<script setup>
import { ref } from 'vue';

const showUserInfo = ref(true);
const user = {
  name: '张三',
  email: 'zhangsan@example.com',
  role: '管理员'
};
</script>
```

`<template>` 元素是一个不可见的包装元素，它不会被渲染到最终的HTML中，只作为包含其他元素的容器。

## v-else 指令

`v-else` 指令用于提供 `v-if` 的"else 块"，它必须紧跟在 `v-if` 或 `v-else-if` 元素之后：

```vue
<template>
  <div>
    <div v-if="isLoggedIn">
      <h2>欢迎回来，{{ username }}</h2>
      <button @click="logout">退出登录</button>
    </div>
    <div v-else>
      <h2>请登录</h2>
      <button @click="login">登录</button>
    </div>
  </div>
</template>

<script setup>
import { ref } from 'vue';

const isLoggedIn = ref(false);
const username = ref('张三');

function login() {
  isLoggedIn.value = true;
}

function logout() {
  isLoggedIn.value = false;
}
</script>
```

在这个例子中，当 `isLoggedIn` 为真时显示欢迎信息和退出按钮，否则显示登录提示和登录按钮。

## v-else-if 指令

`v-else-if` 指令用于提供 `v-if` 的"else if 块"，可以链式使用多个条件：

```vue
<template>
  <div>
    <div v-if="status === 'loading'">
      <p>数据加载中...</p>
      <div class="loading-spinner"></div>
    </div>
    <div v-else-if="status === 'success'">
      <h3>数据加载成功</h3>
      <div class="data-container">
        <!-- 数据内容 -->
      </div>
    </div>
    <div v-else-if="status === 'error'">
      <h3>加载失败</h3>
      <p>错误信息: {{ errorMessage }}</p>
      <button @click="retryLoading">重试</button>
    </div>
    <div v-else>
      <p>未知状态</p>
    </div>
  </div>
</template>

<script setup>
import { ref } from 'vue';

const status = ref('loading');
const errorMessage = ref('');

// 模拟数据加载
setTimeout(() => {
  // 随机模拟成功或失败
  if (Math.random() > 0.3) {
    status.value = 'success';
  } else {
    status.value = 'error';
    errorMessage.value = '网络请求超时，请重试';
  }
}, 2000);

function retryLoading() {
  status.value = 'loading';
  // 重新加载数据...
  setTimeout(() => {
    status.value = 'success';
  }, 2000);
}
</script>

<style scoped>
.loading-spinner {
  width: 30px;
  height: 30px;
  border: 3px solid #f3f3f3;
  border-top: 3px solid #3498db;
  border-radius: 50%;
  animation: spin 1s linear infinite;
}

@keyframes spin {
  0% { transform: rotate(0deg); }
  100% { transform: rotate(360deg); }
}

.data-container {
  padding: 15px;
  border: 1px solid #ddd;
  border-radius: 4px;
  min-height: 100px;
}
</style>
```

这个例子展示了如何根据数据加载状态（loading、success、error）显示不同的内容。

## v-show 指令

`v-show` 是另一个用于条件显示元素的指令，用法类似于 `v-if`：

```vue
<template>
  <div>
    <h2 v-show="isVisible">这段内容会根据条件显示或隐藏</h2>
    <button @click="toggleVisibility">切换显示状态</button>
  </div>
</template>

<script setup>
import { ref } from 'vue';

const isVisible = ref(true);

function toggleVisibility() {
  isVisible.value = !isVisible.value;
}
</script>
```

### v-show 的工作原理

与 `v-if` 不同，`v-show` 只是简单地切换元素的 CSS `display` 属性：

1. 当条件为真时，元素会被显示（`display` 为其原始值）
2. 当条件为假时，元素会被隐藏（`display: none`）
3. 元素始终存在于DOM中，只是视觉上的显示和隐藏

这意味着使用 `v-show` 的元素总是会被渲染并保留在DOM中，只是根据条件切换其可见性。

### v-show 不支持 `<template>` 元素

与 `v-if` 不同，`v-show` 不能用在 `<template>` 元素上，也不支持 `v-else` 或 `v-else-if`。

## v-if vs v-show：如何选择？

`v-if` 和 `v-show` 都可以用来条件性地显示元素，但它们有重要的区别：

| 特性 | v-if | v-show |
|------|------|--------|
| 渲染方式 | 条件为假时，元素完全不渲染（不在DOM中） | 条件为假时，元素仍然渲染，但设置为 `display: none` |
| 切换开销 | 较高（销毁/重建DOM、组件、事件监听器等） | 较低（只切换CSS属性） |
| 初始渲染开销 | 条件为假时没有开销 | 无论条件真假都会渲染 |
| 支持 `<template>` | 支持 | 不支持 |
| 支持 v-else/v-else-if | 支持 | 不支持 |

### 选择建议

- **使用 v-if 的场景**：
  - 条件很少改变的情况（如用户权限、设备类型等）
  - 初始条件为假，且可能长时间保持为假的情况
  - 需要条件性地渲染大量内容或重组件时
  - 需要与 v-else 或 v-else-if 结合使用时

- **使用 v-show 的场景**：
  - 需要频繁切换的情况（如对话框、标签页、折叠面板等）
  - 初始渲染开销不是主要考虑因素
  - 内容简单且切换频率高的情况

```vue
<!-- 适合v-if：用户权限控制，很少变化 -->
<admin-panel v-if="user.isAdmin"></admin-panel>

<!-- 适合v-show：频繁切换的对话框 -->
<dialog-box v-show="isDialogVisible"></dialog-box>
```

## 条件渲染的实际应用

接下来，我们通过几个实际应用示例，展示条件渲染在不同场景下的使用方法。

### 示例1：多级菜单权限控制

```vue
<template>
  <div class="app-container">
    <header>
      <h1>管理系统</h1>
      <div class="user-info" v-if="isLoggedIn">
        <span>欢迎，{{ user.name }}</span>
        <button @click="logout">退出</button>
      </div>
      <button v-else @click="showLoginForm = true">登录</button>
    </header>
    
    <nav class="sidebar">
      <ul class="menu">
        <li>
          <a href="#dashboard">
            <i class="icon-dashboard"></i>
            <span>仪表盘</span>
          </a>
        </li>
        
        <!-- 普通用户和管理员都可见 -->
        <li>
          <a href="#profile">
            <i class="icon-user"></i>
            <span>个人资料</span>
          </a>
        </li>
        
        <!-- 只有管理员可见的菜单 -->
        <template v-if="user.role === 'admin'">
          <li>
            <a href="#users">
              <i class="icon-users"></i>
              <span>用户管理</span>
            </a>
          </li>
          
          <li>
            <a href="#settings">
              <i class="icon-settings"></i>
              <span>系统设置</span>
            </a>
          </li>
        </template>
        
        <!-- 特定权限可见 -->
        <li v-if="hasPermission('content_manage')">
          <a href="#content">
            <i class="icon-content"></i>
            <span>内容管理</span>
          </a>
        </li>
        
        <li v-if="hasPermission('reports_view')">
          <a href="#reports">
            <i class="icon-chart"></i>
            <span>数据报表</span>
          </a>
        </li>
      </ul>
    </nav>
    
    <main class="content">
      <!-- 登录表单 -->
      <div class="login-form" v-if="showLoginForm && !isLoggedIn">
        <h2>用户登录</h2>
        <form @submit.prevent="login">
          <div class="form-group">
            <label for="username">用户名</label>
            <input id="username" v-model="loginForm.username" required />
          </div>
          
          <div class="form-group">
            <label for="password">密码</label>
            <input id="password" type="password" v-model="loginForm.password" required />
          </div>
          
          <div class="form-group">
            <label>
              <input type="checkbox" v-model="loginForm.remember" />
              记住我
            </label>
          </div>
          
          <div v-if="loginError" class="error-message">
            {{ loginError }}
          </div>
          
          <button type="submit" :disabled="isLoggingIn">
            {{ isLoggingIn ? '登录中...' : '登录' }}
          </button>
        </form>
      </div>
      
      <!-- 主内容区 -->
      <div v-else-if="isLoggedIn">
        <h2>欢迎使用管理系统</h2>
        <p>您可以在左侧菜单选择功能。</p>
        
        <!-- 根据用户角色显示不同内容 -->
        <div v-if="user.role === 'admin'" class="admin-dashboard">
          <h3>管理员快捷操作</h3>
          <div class="quick-actions">
            <button>添加用户</button>
            <button>系统配置</button>
            <button>查看日志</button>
          </div>
        </div>
        
        <div v-else class="user-dashboard">
          <h3>常用功能</h3>
          <div class="quick-actions">
            <button>编辑资料</button>
            <button>我的消息</button>
          </div>
        </div>
      </div>
      
      <!-- 未登录且未显示登录表单 -->
      <div v-else class="welcome-screen">
        <h2>欢迎访问管理系统</h2>
        <p>请点击右上角的"登录"按钮进入系统。</p>
      </div>
    </main>
  </div>
</template>

<script setup>
import { ref, reactive } from 'vue';

// 用户登录状态
const isLoggedIn = ref(false);
const isLoggingIn = ref(false);
const loginError = ref('');
const showLoginForm = ref(false);

// 用户信息
const user = reactive({
  name: '',
  role: '',
  permissions: []
});

// 登录表单
const loginForm = reactive({
  username: '',
  password: '',
  remember: false
});

// 登录方法
function login() {
  isLoggingIn.value = true;
  loginError.value = '';
  
  // 模拟API请求
  setTimeout(() => {
    isLoggingIn.value = false;
    
    // 简单的用户名密码验证
    if (loginForm.username === 'admin' && loginForm.password === 'admin123') {
      isLoggedIn.value = true;
      showLoginForm.value = false;
      
      // 设置用户信息
      user.name = 'Admin User';
      user.role = 'admin';
      user.permissions = ['content_manage', 'reports_view', 'user_manage'];
      
    } else if (loginForm.username === 'user' && loginForm.password === 'user123') {
      isLoggedIn.value = true;
      showLoginForm.value = false;
      
      // 设置用户信息
      user.name = 'Normal User';
      user.role = 'user';
      user.permissions = ['content_manage'];
      
    } else {
      loginError.value = '用户名或密码错误';
    }
  }, 1000);
}

// 退出登录
function logout() {
  isLoggedIn.value = false;
  user.name = '';
  user.role = '';
  user.permissions = [];
}

// 检查权限
function hasPermission(permission) {
  return user.permissions.includes(permission);
}
</script>

<style scoped>
.app-container {
  display: flex;
  flex-direction: column;
  min-height: 100vh;
}

header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  padding: 1rem;
  background-color: #333;
  color: white;
}

.user-info {
  display: flex;
  align-items: center;
  gap: 1rem;
}

.sidebar {
  width: 250px;
  background-color: #f5f5f5;
  padding: 1rem 0;
  position: fixed;
  left: 0;
  top: 60px;
  bottom: 0;
}

.menu {
  list-style: none;
  padding: 0;
  margin: 0;
}

.menu li a {
  display: flex;
  align-items: center;
  padding: 0.75rem 1.5rem;
  color: #333;
  text-decoration: none;
}

.menu li a:hover {
  background-color: #e0e0e0;
}

.menu li a i {
  margin-right: 0.5rem;
}

.content {
  margin-left: 250px;
  padding: 2rem;
  flex: 1;
}

.login-form {
  max-width: 400px;
  margin: 0 auto;
  padding: 2rem;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.form-group {
  margin-bottom: 1rem;
}

.form-group label {
  display: block;
  margin-bottom: 0.5rem;
}

.form-group input[type="text"],
.form-group input[type="password"] {
  width: 100%;
  padding: 0.5rem;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.error-message {
  color: red;
  margin: 1rem 0;
}

button {
  padding: 0.5rem 1rem;
  background-color: #4CAF50;
  color: white;
  border: none;
  border-radius: 4px;
  cursor: pointer;
}

button:hover {
  background-color: #45a049;
}

button:disabled {
  background-color: #cccccc;
  cursor: not-allowed;
}

.quick-actions {
  display: flex;
  gap: 1rem;
  margin-top: 1rem;
}
</style>
```

这个示例展示了如何使用条件渲染来实现基于用户角色和权限的菜单控制和内容显示。它包括：

1. 根据登录状态显示不同的头部内容
2. 根据用户角色显示不同的菜单项
3. 根据特定权限显示特定功能
4. 根据状态切换登录表单和主内容区

### 示例2：多步骤表单

```vue
<template>
  <div class="multi-step-form">
    <h2>多步骤注册表单</h2>
    
    <!-- 步骤指示器 -->
    <div class="steps-indicator">
      <div 
        v-for="(step, index) in steps" 
        :key="index"
        class="step"
        :class="{ 
          'active': currentStep === index,
          'completed': currentStep > index 
        }"
      >
        <div class="step-number">{{ index + 1 }}</div>
        <div class="step-title">{{ step.title }}</div>
      </div>
    </div>
    
    <!-- 表单内容 -->
    <div class="form-content">
      <!-- 步骤1：基本信息 -->
      <div v-if="currentStep === 0" class="step-content">
        <h3>{{ steps[0].title }}</h3>
        
        <div class="form-group">
          <label for="username">用户名</label>
          <input 
            id="username" 
            v-model="formData.username"
            :class="{ 'is-invalid': errors.username }"
          />
          <div v-if="errors.username" class="error-message">
            {{ errors.username }}
          </div>
        </div>
        
        <div class="form-group">
          <label for="email">邮箱</label>
          <input 
            id="email" 
            type="email" 
            v-model="formData.email"
            :class="{ 'is-invalid': errors.email }"
          />
          <div v-if="errors.email" class="error-message">
            {{ errors.email }}
          </div>
        </div>
        
        <div class="form-group">
          <label for="password">密码</label>
          <input 
            id="password" 
            type="password" 
            v-model="formData.password"
            :class="{ 'is-invalid': errors.password }"
          />
          <div v-if="errors.password" class="error-message">
            {{ errors.password }}
          </div>
        </div>
      </div>
      
      <!-- 步骤2：个人资料 -->
      <div v-else-if="currentStep === 1" class="step-content">
        <h3>{{ steps[1].title }}</h3>
        
        <div class="form-group">
          <label for="fullName">姓名</label>
          <input 
            id="fullName" 
            v-model="formData.fullName"
            :class="{ 'is-invalid': errors.fullName }"
          />
          <div v-if="errors.fullName" class="error-message">
            {{ errors.fullName }}
          </div>
        </div>
        
        <div class="form-group">
          <label for="phone">手机号码</label>
          <input 
            id="phone" 
            v-model="formData.phone"
            :class="{ 'is-invalid': errors.phone }"
          />
          <div v-if="errors.phone" class="error-message">
            {{ errors.phone }}
          </div>
        </div>
        
        <div class="form-group">
          <label>性别</label>
          <div class="radio-group">
            <label>
              <input type="radio" v-model="formData.gender" value="male" />
              男
            </label>
            <label>
              <input type="radio" v-model="formData.gender" value="female" />
              女
            </label>
          </div>
        </div>
      </div>
      
      <!-- 步骤3：兴趣爱好 -->
      <div v-else-if="currentStep === 2" class="step-content">
        <h3>{{ steps[2].title }}</h3>
        
        <div class="form-group">
          <label>选择您感兴趣的领域（可多选）</label>
          <div class="checkbox-group">
            <label v-for="(interest, index) in interests" :key="index">
              <input 
                type="checkbox" 
                :value="interest.value" 
                v-model="formData.interests"
              />
              {{ interest.label }}
            </label>
          </div>
          <div v-if="errors.interests" class="error-message">
            {{ errors.interests }}
          </div>
        </div>
        
        <div class="form-group">
          <label for="bio">个人简介</label>
          <textarea 
            id="bio" 
            v-model="formData.bio"
            rows="4"
          ></textarea>
        </div>
      </div>
      
      <!-- 步骤4：确认信息 -->
      <div v-else-if="currentStep === 3" class="step-content">
        <h3>{{ steps[3].title }}</h3>
        
        <div class="summary">
          <h4>基本信息</h4>
          <p><strong>用户名：</strong>{{ formData.username }}</p>
          <p><strong>邮箱：</strong>{{ formData.email }}</p>
          
          <h4>个人资料</h4>
          <p><strong>姓名：</strong>{{ formData.fullName }}</p>
          <p><strong>手机号码：</strong>{{ formData.phone }}</p>
          <p><strong>性别：</strong>{{ formData.gender === 'male' ? '男' : '女' }}</p>
          
          <h4>兴趣爱好</h4>
          <p><strong>兴趣领域：</strong>
            <span v-if="formData.interests.length">
              {{ getInterestLabels(formData.interests).join(', ') }}
            </span>
            <span v-else>未选择</span>
          </p>
          <p><strong>个人简介：</strong>{{ formData.bio || '未填写' }}</p>
        </div>
        
        <div class="agreement">
          <label>
            <input type="checkbox" v-model="formData.agreement" />
            我已阅读并同意<a href="#">用户协议</a>和<a href="#">隐私政策</a>
          </label>
          <div v-if="errors.agreement" class="error-message">
            {{ errors.agreement }}
          </div>
        </div>
      </div>
      
      <!-- 完成页面 -->
      <div v-else-if="currentStep === 4" class="step-content completion">
        <div class="success-icon">✓</div>
        <h3>注册成功！</h3>
        <p>感谢您完成注册，您的账号已经创建成功。</p>
        <p>我们已向您的邮箱 {{ formData.email }} 发送了一封验证邮件，请查收并完成邮箱验证。</p>
        <button @click="goToLogin" class="primary-button">
          前往登录
        </button>
      </div>
    </div>
    
    <!-- 表单按钮 -->
    <div v-if="currentStep < 4" class="form-buttons">
      <button 
        v-if="currentStep > 0" 
        @click="prevStep"
        class="secondary-button"
      >
        上一步
      </button>
      
      <button 
        v-if="currentStep < 3" 
        @click="nextStep"
        class="primary-button"
      >
        下一步
      </button>
      
      <button 
        v-else-if="currentStep === 3" 
        @click="submitForm"
        class="primary-button"
        :disabled="isSubmitting"
      >
        {{ isSubmitting ? '提交中...' : '提交' }}
      </button>
    </div>
  </div>
</template>

<script setup>
import { ref, reactive } from 'vue';

// 步骤定义
const steps = [
  { title: '基本信息' },
  { title: '个人资料' },
  { title: '兴趣爱好' },
  { title: '确认信息' }
];

// 兴趣选项
const interests = [
  { label: '技术', value: 'technology' },
  { label: '艺术', value: 'art' },
  { label: '体育', value: 'sports' },
  { label: '音乐', value: 'music' },
  { label: '阅读', value: 'reading' },
  { label: '旅行', value: 'travel' },
  { label: '美食', value: 'food' },
  { label: '电影', value: 'movies' }
];

// 表单数据
const formData = reactive({
  username: '',
  email: '',
  password: '',
  fullName: '',
  phone: '',
  gender: 'male',
  interests: [],
  bio: '',
  agreement: false
});

// 错误信息
const errors = reactive({
  username: '',
  email: '',
  password: '',
  fullName: '',
  phone: '',我将继续编写Vue条件渲染的文档内容。

```markdown:c:\project\kphub\src\frontend\vue\02-基础\2.5-条件渲染.md
  interests: [],
  bio: '',
  agreement: false
});

// 错误信息
const errors = reactive({
  username: '',
  email: '',
  password: '',
  fullName: '',
  phone: '',
  interests: '',
  agreement: ''
});

// 当前步骤
const currentStep = ref(0);
const isSubmitting = ref(false);

// 获取兴趣标签
function getInterestLabels(values) {
  return interests
    .filter(interest => values.includes(interest.value))
    .map(interest => interest.label);
}

// 验证当前步骤
function validateCurrentStep() {
  let isValid = true;
  
  // 清除当前步骤的错误信息
  if (currentStep.value === 0) {
    errors.username = '';
    errors.email = '';
    errors.password = '';
    
    // 验证用户名
    if (!formData.username) {
      errors.username = '请输入用户名';
      isValid = false;
    } else if (formData.username.length < 3) {
      errors.username = '用户名至少需要3个字符';
      isValid = false;
    }
    
    // 验证邮箱
    if (!formData.email) {
      errors.email = '请输入邮箱';
      isValid = false;
    } else if (!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(formData.email)) {
      errors.email = '请输入有效的邮箱地址';
      isValid = false;
    }
    
    // 验证密码
    if (!formData.password) {
      errors.password = '请输入密码';
      isValid = false;
    } else if (formData.password.length < 6) {
      errors.password = '密码至少需要6个字符';
      isValid = false;
    }
  } 
  else if (currentStep.value === 1) {
    errors.fullName = '';
    errors.phone = '';
    
    // 验证姓名
    if (!formData.fullName) {
      errors.fullName = '请输入姓名';
      isValid = false;
    }
    
    // 验证手机号码
    if (!formData.phone) {
      errors.phone = '请输入手机号码';
      isValid = false;
    } else if (!/^\d{11}$/.test(formData.phone)) {
      errors.phone = '请输入有效的11位手机号码';
      isValid = false;
    }
  }
  else if (currentStep.value === 2) {
    errors.interests = '';
    
    // 验证兴趣爱好（可选）
    if (formData.interests.length === 0) {
      // 这里我们不将其视为错误，只是提示
      // errors.interests = '请至少选择一个兴趣领域';
      // isValid = false;
    }
  }
  else if (currentStep.value === 3) {
    errors.agreement = '';
    
    // 验证协议同意
    if (!formData.agreement) {
      errors.agreement = '请阅读并同意用户协议和隐私政策';
      isValid = false;
    }
  }
  
  return isValid;
}

// 下一步
function nextStep() {
  if (validateCurrentStep()) {
    currentStep.value++;
  }
}

// 上一步
function prevStep() {
  if (currentStep.value > 0) {
    currentStep.value--;
  }
}

// 提交表单
function submitForm() {
  if (validateCurrentStep()) {
    isSubmitting.value = true;
    
    // 模拟API请求
    setTimeout(() => {
      isSubmitting.value = false;
      currentStep.value = 4; // 显示完成页面
    }, 1500);
  }
}

// 前往登录
function goToLogin() {
  alert('跳转到登录页面');
}
</script>

<style scoped>
.multi-step-form {
  max-width: 600px;
  margin: 0 auto;
  padding: 2rem;
  border: 1px solid #ddd;
  border-radius: 8px;
  background-color: #fff;
}

.steps-indicator {
  display: flex;
  margin-bottom: 2rem;
}

.step {
  flex: 1;
  text-align: center;
  position: relative;
}

.step:not(:last-child)::after {
  content: '';
  position: absolute;
  top: 20px;
  left: 50%;
  width: 100%;
  height: 2px;
  background-color: #ddd;
}

.step.active .step-number,
.step.completed .step-number {
  background-color: #4CAF50;
  color: white;
}

.step.completed:not(:last-child)::after {
  background-color: #4CAF50;
}

.step-number {
  width: 40px;
  height: 40px;
  border-radius: 50%;
  background-color: #ddd;
  color: #666;
  display: flex;
  align-items: center;
  justify-content: center;
  margin: 0 auto 10px;
  position: relative;
  z-index: 1;
}

.step-title {
  font-size: 14px;
  color: #666;
}

.step.active .step-title {
  color: #333;
  font-weight: bold;
}

.form-content {
  margin-bottom: 2rem;
}

.step-content {
  animation: fadeIn 0.3s;
}

@keyframes fadeIn {
  from { opacity: 0; }
  to { opacity: 1; }
}

.form-group {
  margin-bottom: 1.5rem;
}

.form-group label {
  display: block;
  margin-bottom: 0.5rem;
  font-weight: bold;
}

.form-group input[type="text"],
.form-group input[type="email"],
.form-group input[type="password"],
.form-group textarea {
  width: 100%;
  padding: 0.75rem;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.form-group input.is-invalid,
.form-group textarea.is-invalid {
  border-color: #dc3545;
}

.error-message {
  color: #dc3545;
  font-size: 14px;
  margin-top: 0.5rem;
}

.radio-group,
.checkbox-group {
  display: flex;
  flex-direction: column;
  gap: 0.5rem;
}

.form-buttons {
  display: flex;
  justify-content: space-between;
}

.primary-button {
  padding: 0.75rem 1.5rem;
  background-color: #4CAF50;
  color: white;
  border: none;
  border-radius: 4px;
  cursor: pointer;
}

.primary-button:hover {
  background-color: #45a049;
}

.primary-button:disabled {
  background-color: #cccccc;
  cursor: not-allowed;
}

.secondary-button {
  padding: 0.75rem 1.5rem;
  background-color: #f5f5f5;
  color: #333;
  border: 1px solid #ddd;
  border-radius: 4px;
  cursor: pointer;
}

.secondary-button:hover {
  background-color: #e0e0e0;
}

.summary {
  background-color: #f9f9f9;
  padding: 1.5rem;
  border-radius: 4px;
  margin-bottom: 1.5rem;
}

.summary h4 {
  margin-top: 1rem;
  margin-bottom: 0.5rem;
  border-bottom: 1px solid #ddd;
  padding-bottom: 0.5rem;
}

.summary h4:first-child {
  margin-top: 0;
}

.agreement {
  margin-top: 1.5rem;
}

.completion {
  text-align: center;
}

.success-icon {
  width: 80px;
  height: 80px;
  border-radius: 50%;
  background-color: #4CAF50;
  color: white;
  font-size: 40px;
  display: flex;
  align-items: center;
  justify-content: center;
  margin: 0 auto 1.5rem;
}
</style>
```

这个示例展示了如何使用条件渲染来实现多步骤表单。它使用 `v-if` 和 `v-else-if` 根据当前步骤显示不同的表单内容，并在最后显示完成页面。

### 示例3：数据加载状态处理

```vue
<template>
  <div class="data-loading-demo">
    <h2>产品列表</h2>
    
    <!-- 搜索和筛选 -->
    <div class="filters">
      <div class="search-box">
        <input 
          type="text" 
          v-model="searchQuery" 
          placeholder="搜索产品..." 
          @input="handleSearch"
        />
      </div>
      
      <div class="category-filter">
        <label>分类：</label>
        <select v-model="selectedCategory" @change="handleFilter">
          <option value="">全部</option>
          <option 
            v-for="category in categories" 
            :key="category" 
            :value="category"
          >
            {{ category }}
          </option>
        </select>
      </div>
    </div>
    
    <!-- 加载状态 -->
    <div v-if="loading" class="loading-state">
      <div class="spinner"></div>
      <p>加载中，请稍候...</p>
    </div>
    
    <!-- 错误状态 -->
    <div v-else-if="error" class="error-state">
      <div class="error-icon">!</div>
      <h3>加载失败</h3>
      <p>{{ error }}</p>
      <button @click="fetchProducts">重试</button>
    </div>
    
    <!-- 空数据状态 -->
    <div v-else-if="filteredProducts.length === 0" class="empty-state">
      <div class="empty-icon">🔍</div>
      <h3>未找到产品</h3>
      <p v-if="searchQuery || selectedCategory">
        没有符合当前筛选条件的产品。
        <a href="#" @click.prevent="resetFilters">清除筛选条件</a>
      </p>
      <p v-else>产品列表为空。</p>
    </div>
    
    <!-- 数据展示 -->
    <div v-else class="product-grid">
      <div 
        v-for="product in filteredProducts" 
        :key="product.id"
        class="product-card"
      >
        <div class="product-image">
          <img :src="product.image" :alt="product.name" />
          <span 
            v-if="product.stock <= 0" 
            class="out-of-stock-badge"
          >
            缺货
          </span>
          <span 
            v-else-if="product.stock < 10" 
            class="low-stock-badge"
          >
            库存紧张
          </span>
        </div>
        
        <div class="product-info">
          <h3>{{ product.name }}</h3>
          <p class="product-category">{{ product.category }}</p>
          <p class="product-description">{{ product.description }}</p>
          
          <div class="product-price">
            <span class="current-price">¥{{ product.price.toFixed(2) }}</span>
            <span 
              v-if="product.originalPrice && product.originalPrice > product.price" 
              class="original-price"
            >
              ¥{{ product.originalPrice.toFixed(2) }}
            </span>
          </div>
          
          <button 
            class="add-to-cart-button"
            :disabled="product.stock <= 0"
            @click="addToCart(product)"
          >
            {{ product.stock <= 0 ? '缺货' : '加入购物车' }}
          </button>
        </div>
      </div>
    </div>
    
    <!-- 购物车提示 -->
    <div 
      v-if="cartNotification.show" 
      class="cart-notification"
      :class="{ 'show': cartNotification.show }"
    >
      <div class="notification-content">
        <span>{{ cartNotification.message }}</span>
        <button @click="cartNotification.show = false">×</button>
      </div>
    </div>
  </div>
</template>

<script setup>
import { ref, computed, onMounted } from 'vue';

// 状态变量
const products = ref([]);
const loading = ref(true);
const error = ref(null);
const searchQuery = ref('');
const selectedCategory = ref('');
const categories = ref([]);
const cartNotification = ref({
  show: false,
  message: ''
});

// 计算过滤后的产品
const filteredProducts = computed(() => {
  return products.value.filter(product => {
    // 搜索过滤
    const matchesSearch = searchQuery.value === '' || 
      product.name.toLowerCase().includes(searchQuery.value.toLowerCase()) ||
      product.description.toLowerCase().includes(searchQuery.value.toLowerCase());
    
    // 分类过滤
    const matchesCategory = selectedCategory.value === '' || 
      product.category === selectedCategory.value;
    
    return matchesSearch && matchesCategory;
  });
});

// 获取产品数据
function fetchProducts() {
  loading.value = true;
  error.value = null;
  
  // 模拟API请求
  setTimeout(() => {
    try {
      // 模拟数据
      const data = [
        {
          id: 1,
          name: '高清智能电视',
          category: '电子产品',
          description: '55英寸4K超高清智能电视，支持语音控制',
          price: 3999,
          originalPrice: 4599,
          stock: 15,
          image: 'https://via.placeholder.com/300x200?text=TV'
        },
        {
          id: 2,
          name: '无线蓝牙耳机',
          category: '电子产品',
          description: '主动降噪，长续航，舒适佩戴',
          price: 899,
          originalPrice: 1299,
          stock: 8,
          image: 'https://via.placeholder.com/300x200?text=Headphones'
        },
        {
          id: 3,
          name: '机械键盘',
          category: '电脑配件',
          description: '87键青轴机械键盘，RGB背光',
          price: 299,
          originalPrice: null,
          stock: 0,
          image: 'https://via.placeholder.com/300x200?text=Keyboard'
        },
        {
          id: 4,
          name: '游戏鼠标',
          category: '电脑配件',
          description: '高精度光学传感器，可编程按键',
          price: 199,
          originalPrice: 249,
          stock: 20,
          image: 'https://via.placeholder.com/300x200?text=Mouse'
        },
        {
          id: 5,
          name: '智能手表',
          category: '穿戴设备',
          description: '心率监测，睡眠分析，运动追踪',
          price: 1299,
          originalPrice: 1499,
          stock: 5,
          image: 'https://via.placeholder.com/300x200?text=Watch'
        },
        {
          id: 6,
          name: '健身手环',
          category: '穿戴设备',
          description: '防水设计，长续航，多种运动模式',
          price: 199,
          originalPrice: 299,
          stock: 0,
          image: 'https://via.placeholder.com/300x200?text=Band'
        }
      ];
      
      products.value = data;
      
      // 提取所有分类
      const categorySet = new Set(data.map(product => product.category));
      categories.value = Array.from(categorySet);
      
      loading.value = false;
      
      // 随机模拟错误（10%概率）
      if (Math.random() < 0.1) {
        throw new Error('网络请求失败，请检查您的网络连接');
      }
    } catch (err) {
      error.value = err.message || '加载产品数据失败';
      loading.value = false;
    }
  }, 1500);
}

// 搜索处理
function handleSearch() {
  // 可以在这里添加防抖逻辑
}

// 筛选处理
function handleFilter() {
  // 可以在这里添加额外的筛选逻辑
}

// 重置筛选条件
function resetFilters() {
  searchQuery.value = '';
  selectedCategory.value = '';
}

// 添加到购物车
function addToCart(product) {
  // 这里可以添加实际的购物车逻辑
  cartNotification.value = {
    show: true,
    message: `已将 ${product.name} 添加到购物车`
  };
  
  // 3秒后自动关闭通知
  setTimeout(() => {
    cartNotification.value.show = false;
  }, 3000);
}

// 组件挂载时获取数据
onMounted(() => {
  fetchProducts();
});
</script>

<style scoped>
.data-loading-demo {
  max-width: 1200px;
  margin: 0 auto;
  padding: 2rem;
  position: relative;
}

.filters {
  display: flex;
  justify-content: space-between;
  margin-bottom: 2rem;
}

.search-box input {
  padding: 0.75rem;
  width: 300px;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.category-filter select {
  padding: 0.75rem;
  border: 1px solid #ddd;
  border-radius: 4px;
  min-width: 150px;
}

/* 加载状态 */
.loading-state {
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  padding: 3rem;
}

.spinner {
  width: 50px;
  height: 50px;
  border: 5px solid #f3f3f3;
  border-top: 5px solid #3498db;
  border-radius: 50%;
  animation: spin 1s linear infinite;
  margin-bottom: 1rem;
}

@keyframes spin {
  0% { transform: rotate(0deg); }
  100% { transform: rotate(360deg); }
}

/* 错误状态 */
.error-state {
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  padding: 3rem;
  text-align: center;
}

.error-icon {
  width: 60px;
  height: 60px;
  border-radius: 50%;
  background-color: #e74c3c;
  color: white;
  font-size: 40px;
  font-weight: bold;
  display: flex;
  align-items: center;
  justify-content: center;
  margin-bottom: 1rem;
}

.error-state button {
  margin-top: 1rem;
  padding: 0.75rem 1.5rem;
  background-color: #3498db;
  color: white;
  border: none;
  border-radius: 4px;
  cursor: pointer;
}

/* 空数据状态 */
.empty-state {
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  padding: 3rem;
  text-align: center;
}

.empty-icon {
  font-size: 50px;
  margin-bottom: 1rem;
}

/* 产品网格 */
.product-grid {
  display: grid;
  grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
  gap: 2rem;
}

.product-card {
  border: 1px solid #ddd;
  border-radius: 8px;
  overflow: hidden;
  transition: transform 0.3s, box-shadow 0.3s;
}

.product-card:hover {
  transform: translateY(-5px);
  box-shadow: 0 10px 20px rgba(0, 0, 0, 0.1);
}

.product-image {
  position: relative;
  height: 200px;
}

.product-image img {
  width: 100%;
  height: 100%;
  object-fit: cover;
}

.out-of-stock-badge,
.low-stock-badge {
  position: absolute;
  top: 10px;
  right: 10px;
  padding: 5px 10px;
  border-radius: 4px;
  font-size: 12px;
  font-weight: bold;
}

.out-of-stock-badge {
  background-color: #e74c3c;
  color: white;
}

.low-stock-badge {
  background-color: #f39c12;
  color: white;
}

.product-info {
  padding: 1.5rem;
}

.product-info h3 {
  margin-top: 0;
  margin-bottom: 0.5rem;
}

.product-category {
  color: #666;
  font-size: 14px;
  margin-bottom: 0.5rem;
}

.product-description {
  color: #333;
  margin-bottom: 1rem;
  line-height: 1.5;
}

.product-price {
  display: flex;
  align-items: center;
  margin-bottom: 1rem;
}

.current-price {
  font-size: 20px;
  font-weight: bold;
  color: #e74c3c;
}

.original-price {
  margin-left: 10px;
  font-size: 16px;
  color: #999;
  text-decoration: line-through;
}

.add-to-cart-button {
  width: 100%;
  padding: 0.75rem;
  background-color: #3498db;
  color: white;
  border: none;
  border-radius: 4px;
  cursor: pointer;
  transition: background-color 0.3s;
}

.add-to-cart-button:hover {
  background-color: #2980b9;
}

.add-to-cart-button:disabled {
  background-color: #bdc3c7;
  cursor: not-allowed;
}

/* 购物车通知 */
.cart-notification {
  position: fixed;
  bottom: 20px;
  right: 20px;
  background-color: #2ecc71;
  color: white;
  padding: 1rem;
  border-radius: 4px;
  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
  transform: translateY(100px);
  opacity: 0;
  transition: transform 0.3s, opacity 0.3s;
}

.cart-notification.show {
  transform: translateY(0);
  opacity: 1;
}

.notification-content {
  display: flex;
  align-items: center;
  justify-content: space-between;
}

.notification-content button {
  background: none;
  border: none;
  color: white;
  font-size: 20px;
  cursor: pointer;
  margin-left: 10px;
}
</style>
```

这个示例展示了如何使用条件渲染来处理数据加载的不同状态：

1. 加载中状态（`v-if="loading"`）
2. 错误状态（`v-else-if="error"`）
3. 空数据状态（`v-else-if="filteredProducts.length === 0"`）
4. 数据展示状态（`v-else`）

此外，它还展示了如何在产品卡片中使用条件渲染来显示不同的库存状态和价格信息。

## 条件渲染的最佳实践

在Vue中使用条件渲染时，以下是一些最佳实践：

### 1. 选择合适的条件渲染方式

根据场景选择合适的条件渲染指令：

- 对于不经常变化的条件，使用 `v-if`
- 对于频繁切换的条件，使用 `v-show`
- 对于多个互斥条件，使用 `v-if`/`v-else-if`/`v-else` 链

```vue
<!-- 用户权限控制（不经常变化）-->
<admin-panel v-if="user.isAdmin"></admin-panel>

<!-- 对话框显示/隐藏（频繁切换）-->
<dialog-box v-show="isDialogVisible"></dialog-box>

<!-- 多状态处理 -->
<div v-if="status === 'loading'">加载中...</div>
<div v-else-if="status === 'success'">加载成功</div>
<div v-else-if="status === 'error'">加载失败</div>
<div v-else>未开始加载</div>
```

### 2. 使用计算属性简化条件逻辑

对于复杂的条件逻辑，使用计算属性而不是在模板中直接写复杂表达式：

```vue
<!-- 不推荐 -->
<div v-if="items.length > 0 && items.filter(item => item.active).length > 0 && !isLoading">
  <!-- 内容 -->
</div>

<!-- 推荐 -->
<div v-if="hasActiveItems">
  <!-- 内容 -->
</div>

<script setup>
import { computed } from 'vue';

const hasActiveItems = computed(() => {
  return items.length > 0 && 
         items.filter(item => item.active).length > 0 && 
         !isLoading;
});
</script>
```

### 3. 使用 `<template>` 元素包装多个元素

当需要条件渲染多个元素但不想引入额外的包装元素时，使用 `<template>` 元素：

```vue
<!-- 不推荐：引入额外的div -->
<div v-if="showContent">
  <h2>标题</h2>
  <p>段落1</p>
  <p>段落2</p>
</div>

<!-- 推荐：使用template -->
<template v-if="showContent">
  <h2>标题</h2>
  <p>段落1</p>
  <p>段落2</p>
</template>
```

### 4. 避免 v-if 和 v-for 一起使用

Vue 的文档明确建议不要在同一元素上同时使用 `v-if` 和 `v-for`，因为 `v-for` 的优先级高于 `v-if`，这会导致每次渲染都会先执行循环，然后再检查条件，即使大部分项目可能被过滤掉：

```vue
<!-- 不推荐 -->
<li v-for="user in users" v-if="user.isActive" :key="user.id">
  {{ user.name }}
</li>

<!-- 推荐：使用计算属性过滤 -->
<li v-for="user in activeUsers" :key="user.id">
  {{ user.name }}
</li>

<script setup>
import { computed } from 'vue';

const activeUsers = computed(() => {
  return users.filter(user => user.isActive);
});
</script>

<!-- 或者使用template包装 -->
<template v-for="user in users" :key="user.id">
  <li v-if="user.isActive">
    {{ user.name }}
  </li>
</template>
```

### 5. 使用 key 管理可复用元素

当使用 `v-if` 和 `v-else` 切换元素时，Vue 会尽可能高效地复用元素。如果你不希望元素被复用（例如，两个完全不同的表单），可以添加不同的 `key` 属性：

```vue
<template>
  <div>
    <div v-if="loginType === 'username'" key="username-form">
      <label>用户名</label>
      <input placeholder="输入用户名">
    </div>
    <div v-else key="email-form">
      <label>邮箱</label>
      <input placeholder="输入邮箱">
    </div>
    <button @click="toggleLoginType">切换登录方式</button>
  </div>
</template>

<script setup>
import { ref } from 'vue';

const loginType = ref('username');

function toggleLoginType() {
  loginType.value = loginType.value === 'username' ? 'email' : 'username';
}
</script>
```

在这个例子中，添加 `key` 属性确保了两个输入框不会被复用，切换时会重新创建，而不是仅仅更新标签和占位符。

### 6. 处理加载状态的模式

在处理异步数据时，使用条件渲染来显示不同的加载状态是一种常见模式：

```vue
<template>我将继续编写Vue条件渲染的文档内容。

```markdown:c:\project\kphub\src\frontend\vue\02-基础\2.5-条件渲染.md
<template>
  <div>
    <!-- 加载状态 -->
    <div v-if="loading" class="loading">
      <spinner-component />
      <p>加载中...</p>
    </div>
    
    <!-- 错误状态 -->
    <div v-else-if="error" class="error">
      <p>错误: {{ error }}</p>
      <button @click="fetchData">重试</button>
    </div>
    
    <!-- 空数据状态 -->
    <div v-else-if="items.length === 0" class="empty">
      <p>暂无数据</p>
    </div>
    
    <!-- 数据展示状态 -->
    <div v-else class="content">
      <ul>
        <li v-for="item in items" :key="item.id">
          {{ item.name }}
        </li>
      </ul>
    </div>
  </div>
</template>
```

### 7. 使用延迟加载和骨架屏

对于大型组件，可以结合条件渲染和异步组件实现延迟加载，并使用骨架屏提升用户体验：

```vue
<template>
  <div>
    <!-- 使用骨架屏 -->
    <skeleton-screen v-if="!componentLoaded" />
    
    <!-- 延迟加载的组件 -->
    <heavy-component v-else />
  </div>
</template>

<script setup>
import { ref, onMounted } from 'vue';
import SkeletonScreen from './SkeletonScreen.vue';

const componentLoaded = ref(false);
const HeavyComponent = defineAsyncComponent(() => 
  import('./HeavyComponent.vue')
);

onMounted(() => {
  // 模拟延迟加载
  setTimeout(() => {
    componentLoaded.value = true;
  }, 1000);
});
</script>
```

## 条件渲染的性能考虑

在使用条件渲染时，需要考虑以下性能因素：

### 1. v-if vs v-show 的性能对比

- **v-if**：
  - 初始渲染：如果条件为假，不会渲染元素，初始渲染开销较小
  - 切换开销：较大，涉及DOM元素的创建和销毁
  - 适用场景：条件很少改变的情况

- **v-show**：
  - 初始渲染：无论条件真假都会渲染元素，初始渲染开销较大
  - 切换开销：较小，只是切换CSS display属性
  - 适用场景：需要频繁切换的情况

### 2. 大型组件的条件渲染

对于大型组件或包含大量DOM元素的内容，频繁使用 `v-if` 切换可能导致性能问题。在这种情况下，可以考虑：

1. 使用 `v-show` 代替 `v-if`
2. 结合 `<keep-alive>` 缓存组件状态
3. 使用异步组件和延迟加载

```vue
<template>
  <div>
    <!-- 使用keep-alive缓存组件状态 -->
    <keep-alive>
      <heavy-component v-if="showComponent" />
    </keep-alive>
    
    <button @click="showComponent = !showComponent">
      {{ showComponent ? '隐藏' : '显示' }}组件
    </button>
  </div>
</template>
```

### 3. 避免不必要的重渲染

当条件变化时，Vue会重新渲染相关DOM。为了避免不必要的重渲染，可以：

1. 使用计算属性缓存条件结果
2. 将不变的部分提取到单独的组件中
3. 使用 `v-once` 指令渲染只需要一次的内容

```vue
<template>
  <div>
    <!-- 静态内容只渲染一次 -->
    <header v-once>
      <h1>应用标题</h1>
      <p>这部分内容不会改变</p>
    </header>
    
    <!-- 动态内容 -->
    <main>
      <div v-if="showContent">
        <!-- 动态内容 -->
      </div>
    </main>
  </div>
</template>
```

## 条件渲染与其他Vue特性的结合

条件渲染可以与Vue的其他特性结合使用，创建更强大的交互体验。

### 1. 条件渲染与过渡效果

结合 Vue 的 `<transition>` 组件，可以为条件渲染的元素添加平滑的过渡效果：

```vue
<template>
  <div>
    <button @click="show = !show">
      切换
    </button>
    
    <transition name="fade">
      <p v-if="show">Hello Vue!</p>
    </transition>
  </div>
</template>

<script setup>
import { ref } from 'vue';

const show = ref(true);
</script>

<style>
.fade-enter-active,
.fade-leave-active {
  transition: opacity 0.5s ease;
}

.fade-enter-from,
.fade-leave-to {
  opacity: 0;
}
</style>
```

### 2. 条件渲染与组件插槽

可以结合插槽和条件渲染创建灵活的组件模板：

```vue
<template>
  <div class="card">
    <div class="card-header">
      <slot name="header">
        <!-- 默认标题 -->
        <h3 v-if="title">{{ title }}</h3>
      </slot>
    </div>
    
    <div class="card-body">
      <slot></slot>
    </div>
    
    <div v-if="$slots.footer" class="card-footer">
      <slot name="footer"></slot>
    </div>
  </div>
</template>

<script setup>
defineProps({
  title: String
});
</script>
```

使用这个卡片组件：

```vue
<card title="公告">
  <p>这是一个公告内容。</p>
  
  <!-- 只有提供footer插槽时，才会显示footer部分 -->
  <template #footer>
    <button>查看更多</button>
  </template>
</card>
```

### 3. 条件渲染与Vuex/Pinia状态管理

条件渲染可以基于状态管理库中的状态：

```vue
<template>
  <div>
    <div v-if="isLoggedIn">
      <h2>欢迎回来，{{ username }}</h2>
      <button @click="logout">退出登录</button>
    </div>
    <div v-else>
      <h2>请登录</h2>
      <login-form />
    </div>
  </div>
</template>

<script setup>
import { computed } from 'vue';
import { useStore } from 'vuex'; // 或 import { useUserStore } from '@/stores/user';
import LoginForm from './LoginForm.vue';

const store = useStore();

// 从Vuex获取状态
const isLoggedIn = computed(() => store.state.auth.isLoggedIn);
const username = computed(() => store.state.auth.user?.username);

// 登出方法
function logout() {
  store.dispatch('auth/logout');
}
</script>
```

## 总结

Vue的条件渲染是构建动态用户界面的基础功能之一。通过本文，我们详细了解了：

1. **条件渲染指令**：
   - `v-if`：根据条件真假完全渲染或移除元素
   - `v-else`：提供 `v-if` 的"else 块"
   - `v-else-if`：提供 `v-if` 的"else if 块"
   - `v-show`：根据条件切换元素的显示和隐藏（CSS display）

2. **v-if 和 v-show 的区别**：
   - `v-if` 是"真实的"条件渲染，元素会被完全创建或销毁
   - `v-show` 只是切换元素的CSS display属性
   - `v-if` 有更高的切换开销，`v-show` 有更高的初始渲染开销
   - `v-if` 支持 `<template>`、`v-else` 和 `v-else-if`，而 `v-show` 不支持

3. **实际应用示例**：
   - 多级菜单权限控制
   - 多步骤表单
   - 数据加载状态处理

4. **最佳实践**：
   - 选择合适的条件渲染方式
   - 使用计算属性简化条件逻辑
   - 使用 `<template>` 元素包装多个元素
   - 避免 v-if 和 v-for 一起使用
   - 使用 key 管理可复用元素
   - 处理加载状态的模式
   - 使用延迟加载和骨架屏

5. **性能考虑**：
   - v-if vs v-show 的性能对比
   - 大型组件的条件渲染
   - 避免不必要的重渲染

6. **与其他Vue特性的结合**：
   - 条件渲染与过渡效果
   - 条件渲染与组件插槽
   - 条件渲染与Vuex/Pinia状态管理

通过掌握这些技巧，你可以更有效地构建具有丰富交互体验的Vue应用。条件渲染不仅可以简化代码，还能提高应用的可维护性和用户体验。

无论是简单的显示/隐藏元素，还是复杂的多状态UI，Vue的条件渲染指令都能帮助你以声明式的方式实现这些需求，让你的应用既直观又易于维护。

## 参考资料

- [Vue.js官方文档 - 条件渲染](https://cn.vuejs.org/guide/essentials/conditional.html)
- [Vue.js官方文档 - 过渡效果](https://cn.vuejs.org/guide/built-ins/transition.html)
- [Vue.js官方文档 - 性能优化](https://cn.vuejs.org/guide/best-practices/performance.html)
```

这份文档详细介绍了Vue中条件渲染的各种方法和最佳实践，并通过实际示例展示了如何在不同场景中应用这些技术。文档适合不同级别的开发者阅读，从基础概念到高级应用都有涵盖。