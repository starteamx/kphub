---
title: ES2020-ES2024ç‰¹æ€§
icon: javascript
order: 3
---

# ES2020-ES2024ç‰¹æ€§

ES2020åˆ°ES2024å¸¦æ¥äº†æ›´å¤šç°ä»£JavaScriptç‰¹æ€§ã€‚æœ¬æ–‡å°†ä»‹ç»è¿™äº›ç‰ˆæœ¬çš„ä¸»è¦ç‰¹æ€§ï¼ŒåŒ…æ‹¬å¯é€‰é“¾æ“ä½œç¬¦ã€ç©ºå€¼åˆå¹¶æ“ä½œç¬¦ã€Promise.allSettledã€é€»è¾‘èµ‹å€¼è¿ç®—ç¬¦ã€String.prototype.replaceAllç­‰ï¼Œå¸®åŠ©æ‚¨è·Ÿä¸ŠJavaScriptçš„æœ€æ–°å‘å±•ã€‚

## ES2020 (ES11) ç‰¹æ€§

### 1. å¯é€‰é“¾æ“ä½œç¬¦ï¼ˆOptional Chainingï¼‰

å¯é€‰é“¾æ“ä½œç¬¦ `?.` å…è®¸è¯»å–ä½äºè¿æ¥å¯¹è±¡é“¾æ·±å¤„çš„å±æ€§çš„å€¼ï¼Œè€Œä¸å¿…æ˜ç¡®éªŒè¯é“¾ä¸­çš„æ¯ä¸ªå¼•ç”¨æ˜¯å¦æœ‰æ•ˆã€‚

```javascript
const user = {
  name: 'å¼ ä¸‰',
  address: {
    city: 'åŒ—äº¬'
  }
};

// ä¼ ç»Ÿæ–¹å¼
const city1 = user && user.address && user.address.city;

// ä½¿ç”¨å¯é€‰é“¾
const city2 = user?.address?.city;

// è®¿é—®ä¸å­˜åœ¨çš„å±æ€§
const zipCode = user?.address?.zipCode; // undefinedï¼Œä¸ä¼šæŠ¥é”™

// ä¸æ–¹æ³•è°ƒç”¨ç»“åˆ
const result = user.getDetails?.(); // å¦‚æœgetDetailsæ–¹æ³•ä¸å­˜åœ¨ï¼Œè¿”å›undefined

// ä¸æ•°ç»„ç»“åˆ
const firstItem = arr?.[0]; // å¦‚æœarrä¸å­˜åœ¨ï¼Œè¿”å›undefined
```

### 2. ç©ºå€¼åˆå¹¶æ“ä½œç¬¦ï¼ˆNullish Coalescingï¼‰

ç©ºå€¼åˆå¹¶æ“ä½œç¬¦ `??` æ˜¯ä¸€ä¸ªé€»è¾‘æ“ä½œç¬¦ï¼Œå½“å·¦ä¾§çš„æ“ä½œæ•°ä¸º `null` æˆ– `undefined` æ—¶ï¼Œè¿”å›å³ä¾§çš„æ“ä½œæ•°ï¼Œå¦åˆ™è¿”å›å·¦ä¾§çš„æ“ä½œæ•°ã€‚

```javascript
// ä¼ ç»Ÿæ–¹å¼ä½¿ç”¨ || æ“ä½œç¬¦
const count1 = someValue || 10;
// é—®é¢˜ï¼šå½“someValueä¸º0ã€''ã€falseæ—¶ä¹Ÿä¼šè¿”å›10

// ä½¿ç”¨ç©ºå€¼åˆå¹¶æ“ä½œç¬¦
const count2 = someValue ?? 10;
// åªæœ‰å½“someValueä¸ºnullæˆ–undefinedæ—¶æ‰è¿”å›10

// å®é™…åº”ç”¨
function printMessage(message) {
  console.log(message ?? 'æ²¡æœ‰æ¶ˆæ¯');
}

printMessage('Hello'); // 'Hello'
printMessage(''); // ''ï¼ˆç©ºå­—ç¬¦ä¸²ä¼šè¢«ä¿ç•™ï¼‰
printMessage(0); // 0ï¼ˆ0ä¼šè¢«ä¿ç•™ï¼‰
printMessage(null); // 'æ²¡æœ‰æ¶ˆæ¯'
printMessage(undefined); // 'æ²¡æœ‰æ¶ˆæ¯'
```

### 3. Promise.allSettled()

`Promise.allSettled()` æ–¹æ³•è¿”å›ä¸€ä¸ªåœ¨æ‰€æœ‰ç»™å®šçš„ promise éƒ½å·²ç» fulfilled æˆ– rejected åçš„ promiseï¼Œå¹¶å¸¦æœ‰ä¸€ä¸ªå¯¹è±¡æ•°ç»„ï¼Œæ¯ä¸ªå¯¹è±¡è¡¨ç¤ºå¯¹åº”çš„ promise ç»“æœã€‚

```javascript
const promises = [
  fetch('/api/user').then(response => response.json()),
  fetch('/api/posts').then(response => response.json()),
  fetch('/api/nonexistent').then(response => response.json())
];

// Promise.all åœ¨ä»»ä½•ä¸€ä¸ª promise è¢«æ‹’ç»æ—¶å°±ä¼šæ‹’ç»
Promise.all(promises)
  .then(results => console.log('æ‰€æœ‰è¯·æ±‚æˆåŠŸ:', results))
  .catch(error => console.error('è‡³å°‘ä¸€ä¸ªè¯·æ±‚å¤±è´¥:', error));

// Promise.allSettled ä¼šç­‰å¾…æ‰€æœ‰ promise å®Œæˆï¼Œæ— è®ºæˆåŠŸæˆ–å¤±è´¥
Promise.allSettled(promises)
  .then(results => {
    // å¤„ç†æ‰€æœ‰ç»“æœ
    results.forEach((result, index) => {
      if (result.status === 'fulfilled') {
        console.log(`è¯·æ±‚ ${index + 1} æˆåŠŸ:`, result.value);
      } else {
        console.log(`è¯·æ±‚ ${index + 1} å¤±è´¥:`, result.reason);
      }
    });
  });
```

### 4. BigInt

BigInt æ˜¯ä¸€ç§å†…ç½®å¯¹è±¡ï¼Œæä¾›äº†ä¸€ç§è¡¨ç¤ºå¤§äº 2^53 - 1 çš„æ•´æ•°çš„æ–¹æ³•ã€‚

```javascript
// åˆ›å»º BigInt
const bigInt1 = 9007199254740991n; // ä½¿ç”¨nåç¼€
const bigInt2 = BigInt(9007199254740991); // ä½¿ç”¨æ„é€ å‡½æ•°

// BigInt è¿ç®—
const sum = bigInt1 + bigInt2;
const product = bigInt1 * bigInt2;

// BigInt ä¸èƒ½ä¸æ™®é€šæ•°å­—æ··åˆè¿ç®—
// const mixed = bigInt1 + 1; // TypeError

// å¿…é¡»æ˜¾å¼è½¬æ¢
const mixed = bigInt1 + BigInt(1);

// æ¯”è¾ƒæ“ä½œ
console.log(1n < 2); // true
console.log(2n > 1); // true
console.log(1n == 1); // true
console.log(1n === 1); // falseï¼Œç±»å‹ä¸åŒ

// é™¤æ³•æ€»æ˜¯è¿”å›æ•´æ•°ï¼Œå‘é›¶å–æ•´
console.log(5n / 2n); // 2nï¼Œè€Œä¸æ˜¯2.5n
```

### 5. globalThis

`globalThis` æä¾›äº†ä¸€ä¸ªæ ‡å‡†çš„æ–¹å¼æ¥è·å–ä¸åŒç¯å¢ƒä¸‹çš„å…¨å±€ this å¯¹è±¡ã€‚

```javascript
// åœ¨æµè§ˆå™¨ä¸­
// window === globalThis

// åœ¨Node.jsä¸­
// global === globalThis

// åœ¨Web Workerä¸­
// self === globalThis

// ä½¿ç”¨ globalThis å¯ä»¥åœ¨ä»»ä½•ç¯å¢ƒä¸­è·å–å…¨å±€å¯¹è±¡
console.log(globalThis);

// è·¨ç¯å¢ƒä»£ç ç¤ºä¾‹
function createGlobal(key, value) {
  globalThis[key] = value;
}

createGlobal('myGlobalVar', 42);
console.log(globalThis.myGlobalVar); // 42
```

### 6. åŠ¨æ€å¯¼å…¥ï¼ˆDynamic Importï¼‰

åŠ¨æ€å¯¼å…¥å…è®¸æŒ‰éœ€å¯¼å…¥æ¨¡å—ï¼Œè€Œä¸æ˜¯åœ¨æ–‡ä»¶å¼€å¤´é™æ€å¯¼å…¥æ‰€æœ‰æ¨¡å—ã€‚

```javascript
// é™æ€å¯¼å…¥ï¼ˆå§‹ç»ˆåŠ è½½ï¼‰
import { add } from './math.js';

// åŠ¨æ€å¯¼å…¥ï¼ˆæŒ‰éœ€åŠ è½½ï¼‰
button.addEventListener('click', async () => {
  try {
    // åªæœ‰åœ¨ç‚¹å‡»æŒ‰é’®æ—¶æ‰åŠ è½½æ¨¡å—
    const mathModule = await import('./math.js');
    console.log(mathModule.add(1, 2)); // 3
    
    // ä½¿ç”¨è§£æ„
    const { multiply } = await import('./math.js');
    console.log(multiply(2, 3)); // 6
  } catch (error) {
    console.error('æ¨¡å—åŠ è½½å¤±è´¥:', error);
  }
});
```

### 7. String.prototype.matchAll()

`matchAll()` æ–¹æ³•è¿”å›ä¸€ä¸ªåŒ…å«æ‰€æœ‰åŒ¹é…æ­£åˆ™è¡¨è¾¾å¼çš„ç»“æœåŠåˆ†ç»„æ•è·ç»„çš„è¿­ä»£å™¨ã€‚

```javascript
const text = 'test1test2test3';
const pattern = /test(\d)/g;

// ä¼ ç»Ÿæ–¹å¼
let match;
while ((match = pattern.exec(text)) !== null) {
  console.log(`æ‰¾åˆ° ${match[0]} åœ¨ä½ç½® ${match.index}ï¼Œæ•è·ç»„: ${match[1]}`);
}

// ä½¿ç”¨ matchAll
const matches = text.matchAll(pattern);
for (const match of matches) {
  console.log(`æ‰¾åˆ° ${match[0]} åœ¨ä½ç½® ${match.index}ï¼Œæ•è·ç»„: ${match[1]}`);
}

// è½¬æ¢ä¸ºæ•°ç»„
const matchArray = [...text.matchAll(pattern)];
console.log(matchArray);
```

## ES2021 (ES12) ç‰¹æ€§

### 1. String.prototype.replaceAll()

`replaceAll()` æ–¹æ³•è¿”å›ä¸€ä¸ªæ–°å­—ç¬¦ä¸²ï¼Œå…¶ä¸­æ‰€æœ‰åŒ¹é…çš„å­å­—ç¬¦ä¸²éƒ½è¢«æ›¿æ¢ã€‚

```javascript
const text = 'hello world, hello javascript';

// ä¼ ç»Ÿæ–¹å¼ä½¿ç”¨æ­£åˆ™è¡¨è¾¾å¼
const result1 = text.replace(/hello/g, 'hi');

// ä½¿ç”¨ replaceAll
const result2 = text.replaceAll('hello', 'hi');
console.log(result2); // 'hi world, hi javascript'

// ä¹Ÿå¯ä»¥ä½¿ç”¨æ­£åˆ™è¡¨è¾¾å¼
const result3 = text.replaceAll(/hello/g, 'hi');
console.log(result3); // 'hi world, hi javascript'

// æ³¨æ„ï¼šä½¿ç”¨æ­£åˆ™è¡¨è¾¾å¼æ—¶å¿…é¡»å¸¦æœ‰å…¨å±€æ ‡å¿—g
// text.replaceAll(/hello/, 'hi'); // TypeError
```

### 2. Promise.any()

`Promise.any()` æ¥æ”¶ä¸€ä¸ª Promise å¯è¿­ä»£å¯¹è±¡ï¼Œåªè¦å…¶ä¸­çš„ä¸€ä¸ª promise æˆåŠŸï¼Œå°±è¿”å›é‚£ä¸ªå·²æˆåŠŸçš„ promiseã€‚

```javascript
const promises = [
  fetch('/api/endpoint1').then(response => response.json()),
  fetch('/api/endpoint2').then(response => response.json()),
  fetch('/api/endpoint3').then(response => response.json())
];

// Promise.any è¿”å›ç¬¬ä¸€ä¸ªæˆåŠŸçš„ promise
Promise.any(promises)
  .then(result => {
    console.log('è‡³å°‘ä¸€ä¸ªè¯·æ±‚æˆåŠŸ:', result);
  })
  .catch(error => {
    // æ‰€æœ‰ promise éƒ½å¤±è´¥æ—¶ï¼Œè¿”å› AggregateError
    console.error('æ‰€æœ‰è¯·æ±‚éƒ½å¤±è´¥äº†:', error);
    console.error('é”™è¯¯æ•°é‡:', error.errors.length);
  });
```

### 3. é€»è¾‘èµ‹å€¼è¿ç®—ç¬¦

é€»è¾‘èµ‹å€¼è¿ç®—ç¬¦ç»“åˆäº†é€»è¾‘è¿ç®—ç¬¦å’Œèµ‹å€¼è¡¨è¾¾å¼ã€‚

```javascript
// é€»è¾‘ä¸èµ‹å€¼ (&&=)
let x = 1;
x &&= 2; // ç­‰åŒäº x = x && 2
console.log(x); // 2

let y = 0;
y &&= 2; // ç­‰åŒäº y = y && 2
console.log(y); // 0ï¼Œå› ä¸º 0 && 2 çš„ç»“æœæ˜¯ 0

// é€»è¾‘æˆ–èµ‹å€¼ (||=)
let a = null;
a ||= 'default'; // ç­‰åŒäº a = a || 'default'
console.log(a); // 'default'

let b = 'value';
b ||= 'default'; // ç­‰åŒäº b = b || 'default'
console.log(b); // 'value'ï¼Œå› ä¸º 'value' || 'default' çš„ç»“æœæ˜¯ 'value'

// ç©ºå€¼åˆå¹¶èµ‹å€¼ (??=)
let c = null;
c ??= 'default'; // ç­‰åŒäº c = c ?? 'default'
console.log(c); // 'default'

let d = 0;
d ??= 'default'; // ç­‰åŒäº d = d ?? 'default'
console.log(d); // 0ï¼Œå› ä¸º 0 ?? 'default' çš„ç»“æœæ˜¯ 0
```

### 4. æ•°å­—åˆ†éš”ç¬¦

æ•°å­—åˆ†éš”ç¬¦å…è®¸ä½¿ç”¨ä¸‹åˆ’çº¿ï¼ˆ_ï¼‰ä½œä¸ºåˆ†éš”ç¬¦æ¥æé«˜æ•°å­—çš„å¯è¯»æ€§ã€‚

```javascript
// å¤§æ•°å€¼
const billion = 1_000_000_000; // 10äº¿
console.log(billion); // 1000000000

// äºŒè¿›åˆ¶
const binary = 0b1010_0001_1000_0101;
console.log(binary); // 41349

// åå…­è¿›åˆ¶
const hex = 0xA1_B2_C3;
console.log(hex); // 10602179

// ç§‘å­¦è®¡æ•°æ³•
const scientific = 1.234_567e8;
console.log(scientific); // 123456700

// å°æ•°
const decimal = 1_234.567_89;
console.log(decimal); // 1234.56789
```

### 5. WeakRef å’Œ FinalizationRegistry

`WeakRef` å¯¹è±¡å…è®¸ä¿ç•™å¯¹å¦ä¸€ä¸ªå¯¹è±¡çš„å¼±å¼•ç”¨ï¼Œè€Œä¸ä¼šé˜»æ­¢è¢«å¼•ç”¨å¯¹è±¡è¢«åƒåœ¾å›æ”¶ã€‚`FinalizationRegistry` å…è®¸åœ¨å¯¹è±¡è¢«åƒåœ¾å›æ”¶æ—¶è¯·æ±‚å›è°ƒã€‚

```javascript
// WeakRef ç¤ºä¾‹
let target = { data: "valuable data" };
const weakRef = new WeakRef(target);

// è·å–ç›®æ ‡å¯¹è±¡ï¼ˆå¦‚æœå®ƒä»ç„¶å­˜åœ¨ï¼‰
const obj = weakRef.deref();
if (obj) {
  console.log(obj.data);
} else {
  console.log("å¯¹è±¡å·²è¢«åƒåœ¾å›æ”¶");
}

// æ¸…é™¤å¼ºå¼•ç”¨ï¼Œå…è®¸åƒåœ¾å›æ”¶
target = null;

// FinalizationRegistry ç¤ºä¾‹
const registry = new FinalizationRegistry((value) => {
  console.log(`å¯¹è±¡è¢«åƒåœ¾å›æ”¶äº†ï¼Œå…³è”å€¼: ${value}`);
});

let object = { name: "æµ‹è¯•å¯¹è±¡" };
registry.register(object, "å¯¹è±¡1");

// æ¸…é™¤å¼ºå¼•ç”¨ï¼Œå…è®¸åƒåœ¾å›æ”¶
object = null;
```

## ES2022 (ES13) ç‰¹æ€§

### 1. ç±»å­—æ®µï¼ˆClass Fieldsï¼‰

ES2022 æ ‡å‡†åŒ–äº†ç±»å­—æ®µè¯­æ³•ï¼ŒåŒ…æ‹¬å…¬å…±å­—æ®µã€ç§æœ‰å­—æ®µã€é™æ€å­—æ®µå’Œé™æ€ç§æœ‰æ–¹æ³•ã€‚

```javascript
class Person {
  // å…¬å…±å­—æ®µ
  name = 'å¼ ä¸‰';
  age = 30;
  
  // ç§æœ‰å­—æ®µï¼ˆä½¿ç”¨ # å‰ç¼€ï¼‰
  #privateField = 'private';
  
  // é™æ€å…¬å…±å­—æ®µ
  static type = 'human';
  
  // é™æ€ç§æœ‰å­—æ®µ
  static #count = 0;
  
  constructor() {
    Person.#incrementCount();
  }
  
  // å®ä¾‹æ–¹æ³•
  greet() {
    return `ä½ å¥½ï¼Œæˆ‘æ˜¯${this.name}ï¼Œä»Šå¹´${this.age}å²ã€‚`;
  }
  
  // ç§æœ‰æ–¹æ³•
  #privateMethod() {
    return this.#privateField;
  }
  
  // å…¬å…±æ–¹æ³•è®¿é—®ç§æœ‰å†…å®¹
  getPrivateData() {
    return this.#privateMethod();
  }
  
  // é™æ€å…¬å…±æ–¹æ³•
  static getCount() {
    return Person.#count;
  }
  
  // é™æ€ç§æœ‰æ–¹æ³•
  static #incrementCount() {
    this.#count++;
  }
}

const person = new Person();
console.log(person.name); // 'å¼ ä¸‰'
console.log(person.greet()); // 'ä½ å¥½ï¼Œæˆ‘æ˜¯å¼ ä¸‰ï¼Œä»Šå¹´30å²ã€‚'
console.log(person.getPrivateData()); // 'private'
console.log(Person.type); // 'human'
console.log(Person.getCount()); // 1

// ä»¥ä¸‹ä»£ç ä¼šæŠ¥é”™
// console.log(person.#privateField); // SyntaxError
// person.#privateMethod(); // SyntaxError
// console.log(Person.#count); // SyntaxError
// Person.#incrementCount(); // SyntaxError
```

### 2. ç§æœ‰å®ä¾‹æ–¹æ³•å’Œè®¿é—®å™¨

ES2022 å…è®¸åœ¨ç±»ä¸­å®šä¹‰ç§æœ‰å®ä¾‹æ–¹æ³•å’Œè®¿é—®å™¨ã€‚

```javascript
class Counter {
  #count = 0;
  
  // ç§æœ‰æ–¹æ³•
  #increment() {
    this.#count++;
  }
  
  // ç§æœ‰ getter
  get #value() {
    return this.#count;
  }
  // ç§æœ‰ setter
  set #value(newValue) {
    if (newValue >= 0) {
      this.#count = newValue;
    }
  }
  
  // å…¬å…±æ–¹æ³•è°ƒç”¨ç§æœ‰æ–¹æ³•å’Œè®¿é—®å™¨
  increment() {
    this.#increment();
    return this;
  }
  
  getValue() {
    return this.#value;
  }
  
  setValue(value) {
    this.#value = value;
    return this;
  }
}

const counter = new Counter();
counter.increment().increment();
console.log(counter.getValue()); // 2
counter.setValue(10);
console.log(counter.getValue()); // 10
```

### 3. é¡¶å±‚ await

ES2022 å…è®¸åœ¨ async å‡½æ•°å¤–éƒ¨ä½¿ç”¨ awaitï¼Œå³åœ¨æ¨¡å—çš„é¡¶å±‚ä½¿ç”¨ awaitã€‚

```javascript
// ä»¥å‰ï¼Œawait åªèƒ½åœ¨ async å‡½æ•°å†…éƒ¨ä½¿ç”¨
async function getData() {
  const response = await fetch('/api/data');
  const data = await response.json();
  return data;
}

// ES2022 å…è®¸åœ¨æ¨¡å—é¡¶å±‚ä½¿ç”¨ await
// module.js
const response = await fetch('/api/data');
const data = await response.json();

export { data };

// å¯¼å…¥ä½¿ç”¨é¡¶å±‚ await çš„æ¨¡å—
import { data } from './module.js';
// å¯¼å…¥ä¼šç­‰å¾…é¡¶å±‚ await å®Œæˆ
console.log(data);
```

### 4. Object.hasOwn()

`Object.hasOwn()` æ˜¯ `Object.prototype.hasOwnProperty()` çš„ä¸€ä¸ªæ›´å®‰å…¨çš„æ›¿ä»£æ–¹æ³•ã€‚

```javascript
const object = {
  property: 'value'
};

// ä¼ ç»Ÿæ–¹å¼
console.log(object.hasOwnProperty('property')); // true

// ä½¿ç”¨ Object.hasOwn
console.log(Object.hasOwn(object, 'property')); // true

// å½“åŸå‹é“¾è¢«ä¿®æ”¹æ—¶æ›´å®‰å…¨
const obj = Object.create(null); // æ²¡æœ‰åŸå‹é“¾
obj.property = 'value';

// ä»¥ä¸‹ä¼šæŠ›å‡ºé”™è¯¯ï¼Œå› ä¸º obj æ²¡æœ‰ hasOwnProperty æ–¹æ³•
// console.log(obj.hasOwnProperty('property')); // TypeError

// Object.hasOwn ä»ç„¶æœ‰æ•ˆ
console.log(Object.hasOwn(obj, 'property')); // true
```

### 5. æ­£åˆ™è¡¨è¾¾å¼åŒ¹é…ç´¢å¼•

ES2022 å¼•å…¥äº† `/d` æ ‡å¿—ï¼Œä½¿æ­£åˆ™è¡¨è¾¾å¼åŒ¹é…ç»“æœåŒ…å«æ¯ä¸ªæ•è·ç»„çš„å¼€å§‹å’Œç»“æŸç´¢å¼•ã€‚

```javascript
const text = 'JavaScript is awesome';
const regex = /(\w+)\s+is\s+(\w+)/d;
const match = regex.exec(text);

console.log(match.indices); // [[0, 21], [0, 10], [14, 21]]
// ç¬¬ä¸€ä¸ªæ•°ç»„ [0, 21] è¡¨ç¤ºæ•´ä¸ªåŒ¹é…çš„å¼€å§‹å’Œç»“æŸç´¢å¼•
// ç¬¬äºŒä¸ªæ•°ç»„ [0, 10] è¡¨ç¤ºç¬¬ä¸€ä¸ªæ•è·ç»„ "JavaScript" çš„å¼€å§‹å’Œç»“æŸç´¢å¼•
// ç¬¬ä¸‰ä¸ªæ•°ç»„ [14, 21] è¡¨ç¤ºç¬¬äºŒä¸ªæ•è·ç»„ "awesome" çš„å¼€å§‹å’Œç»“æŸç´¢å¼•

// å‘½åæ•è·ç»„ä¹Ÿæ”¯æŒç´¢å¼•
const namedRegex = /(?<first>\w+)\s+is\s+(?<second>\w+)/d;
const namedMatch = namedRegex.exec(text);

console.log(namedMatch.indices.groups);
// { first: [0, 10], second: [14, 21] }
```

### 6. Error Cause

ES2022 å¼•å…¥äº† Error Causeï¼Œå…è®¸åœ¨åˆ›å»ºé”™è¯¯æ—¶æŒ‡å®šåŸå› ã€‚

```javascript
try {
  // å°è¯•è·å–æ•°æ®
  try {
    const response = await fetch('/api/data');
    if (!response.ok) {
      throw new Error('API è¯·æ±‚å¤±è´¥', { cause: { status: response.status } });
    }
    const data = await response.json();
    processData(data);
  } catch (error) {
    // åŒ…è£…é”™è¯¯å¹¶ä¿ç•™åŸå› 
    throw new Error('æ•°æ®å¤„ç†å¤±è´¥', { cause: error });
  }
} catch (error) {
  console.error('æ“ä½œå¤±è´¥:', error);
  console.error('åŸå› :', error.cause);
}
```

## ES2023 (ES14) ç‰¹æ€§

### 1. Array æŸ¥æ‰¾æœ€åä¸€ä¸ªå…ƒç´ 

ES2023 å¼•å…¥äº† `findLast()` å’Œ `findLastIndex()` æ–¹æ³•ï¼Œç”¨äºä»æ•°ç»„æœ«å°¾å¼€å§‹æŸ¥æ‰¾å…ƒç´ ã€‚

```javascript
const array = [1, 2, 3, 4, 5, 2, 6];

// ä»åå‘å‰æŸ¥æ‰¾ç¬¬ä¸€ä¸ªåŒ¹é…çš„å…ƒç´ 
const lastEven = array.findLast(num => num % 2 === 0);
console.log(lastEven); // 6

// ä»åå‘å‰æŸ¥æ‰¾ç¬¬ä¸€ä¸ªåŒ¹é…çš„å…ƒç´ çš„ç´¢å¼•
const lastEvenIndex = array.findLastIndex(num => num % 2 === 0);
console.log(lastEvenIndex); // 6

// ä¸ä»å‰å‘åæŸ¥æ‰¾çš„æ–¹æ³•æ¯”è¾ƒ
const firstEven = array.find(num => num % 2 === 0);
console.log(firstEven); // 2

const firstEvenIndex = array.findIndex(num => num % 2 === 0);
console.log(firstEvenIndex); // 1
```

### 2. Hashbang è¯­æ³•

ES2023 æ ‡å‡†åŒ–äº† Hashbang è¯­æ³•ï¼Œå…è®¸ JavaScript æ–‡ä»¶ä»¥ `#!` å¼€å¤´ï¼Œç”¨äºåœ¨ç±» Unix ç³»ç»Ÿä¸­åˆ›å»ºå¯æ‰§è¡Œè„šæœ¬ã€‚

```javascript
#!/usr/bin/env node

// è¿™æ˜¯ä¸€ä¸ªå¯æ‰§è¡Œçš„ Node.js è„šæœ¬
console.log('Hello, world!');
```

### 3. Symbols ä½œä¸º WeakMap é”®

ES2023 å…è®¸ä½¿ç”¨ Symbol ä½œä¸º WeakMap çš„é”®ï¼Œå‰ææ˜¯è¿™äº› Symbol æ˜¯ä½¿ç”¨ `Symbol.for()` åˆ›å»ºçš„ã€‚

```javascript
// åˆ›å»ºå…±äº«çš„ Symbol
const userSymbol = Symbol.for('user');
const roleSymbol = Symbol.for('role');

// ä½¿ç”¨ Symbol ä½œä¸º WeakMap çš„é”®
const userMetadata = new WeakMap();
userMetadata.set(userSymbol, { lastAccess: Date.now() });
userMetadata.set(roleSymbol, { permissions: ['read', 'write'] });

console.log(userMetadata.get(userSymbol)); // { lastAccess: ... }
console.log(userMetadata.get(roleSymbol)); // { permissions: ['read', 'write'] }

// æ³¨æ„ï¼šéå…±äº«çš„ Symbol ä¸èƒ½ç”¨ä½œ WeakMap çš„é”®
const localSymbol = Symbol('local');
// ä»¥ä¸‹ä»£ç ä¼šæŠ›å‡ºé”™è¯¯
// userMetadata.set(localSymbol, { data: 'value' }); // TypeError
```

## ES2024 (ES15) ç‰¹æ€§

### 1. Promise.withResolvers()

ES2024 å¼•å…¥äº† `Promise.withResolvers()` æ–¹æ³•ï¼Œå®ƒè¿”å›ä¸€ä¸ªå¯¹è±¡ï¼ŒåŒ…å«ä¸€ä¸ªæ–°çš„ Promise åŠå…¶ resolve å’Œ reject å‡½æ•°ã€‚

```javascript
// ä¼ ç»Ÿæ–¹å¼
let resolveFunction, rejectFunction;
const promise = new Promise((resolve, reject) => {
  resolveFunction = resolve;
  rejectFunction = reject;
});

// ä½¿ç”¨ Promise.withResolvers()
const { promise: newPromise, resolve, reject } = Promise.withResolvers();

// ç°åœ¨å¯ä»¥åœ¨ä»»ä½•åœ°æ–¹è°ƒç”¨ resolve æˆ– reject
setTimeout(() => {
  resolve('æ“ä½œæˆåŠŸ');
}, 1000);

// ç­‰å¾… Promise å®Œæˆ
newPromise.then(result => {
  console.log(result); // 'æ“ä½œæˆåŠŸ'
});
```

### 2. æ•°ç»„å’Œ TypedArray çš„å¤åˆ¶æ–¹æ³•

ES2024 ä¸ºæ•°ç»„å’Œ TypedArray æ·»åŠ äº† `toReversed()`ã€`toSorted()`ã€`toSpliced()` å’Œ `with()` æ–¹æ³•ï¼Œè¿™äº›æ–¹æ³•ä¸ä¼šä¿®æ”¹åŸæ•°ç»„ï¼Œè€Œæ˜¯è¿”å›æ–°æ•°ç»„ã€‚

```javascript
const array = [1, 2, 3, 4, 5];

// è¿”å›åè½¬çš„æ–°æ•°ç»„ï¼Œä¸ä¿®æ”¹åŸæ•°ç»„
const reversed = array.toReversed();
console.log(reversed); // [5, 4, 3, 2, 1]
console.log(array); // [1, 2, 3, 4, 5]

// è¿”å›æ’åºçš„æ–°æ•°ç»„ï¼Œä¸ä¿®æ”¹åŸæ•°ç»„
const sorted = array.toSorted((a, b) => b - a);
console.log(sorted); // [5, 4, 3, 2, 1]
console.log(array); // [1, 2, 3, 4, 5]

// è¿”å›åˆ é™¤/æ’å…¥å…ƒç´ åçš„æ–°æ•°ç»„ï¼Œä¸ä¿®æ”¹åŸæ•°ç»„
const spliced = array.toSpliced(1, 2, 10, 20);
console.log(spliced); // [1, 10, 20, 4, 5]
console.log(array); // [1, 2, 3, 4, 5]

// è¿”å›æ›¿æ¢æŒ‡å®šç´¢å¼•å…ƒç´ åçš„æ–°æ•°ç»„ï¼Œä¸ä¿®æ”¹åŸæ•°ç»„
const replaced = array.with(2, 30);
console.log(replaced); // [1, 2, 30, 4, 5]
console.log(array); // [1, 2, 3, 4, 5]
```

### 3. RegExp v æ ‡å¿—ï¼ˆUnicode é›†åˆç±»ï¼‰

ES2024 å¼•å…¥äº†æ­£åˆ™è¡¨è¾¾å¼çš„ `v` æ ‡å¿—ï¼Œæä¾›äº†å¢å¼ºçš„ Unicode é›†åˆç±»æ”¯æŒã€‚

```javascript
// ä½¿ç”¨ v æ ‡å¿—çš„æ­£åˆ™è¡¨è¾¾å¼
const regex = /[\p{Emoji}]/v;

console.log(regex.test('ğŸ˜Š')); // true
console.log(regex.test('A')); // false

// é›†åˆæ“ä½œ
const letterOrDigit = /[\p{Letter}--\p{Script=Greek}]/v;
console.log(letterOrDigit.test('A')); // true (æ‹‰ä¸å­—æ¯)
console.log(letterOrDigit.test('Î±')); // false (å¸Œè…Šå­—æ¯)

// å±æ€§å€¼åˆ«å
const greekOrCoptic = /[\p{Greek}]/v;
console.log(greekOrCoptic.test('Î±')); // true
```

### 4. ç±»é™æ€åˆå§‹åŒ–å—

ES2024 æ ‡å‡†åŒ–äº†ç±»é™æ€åˆå§‹åŒ–å—ï¼Œå…è®¸åœ¨ç±»å®šä¹‰ä¸­æ‰§è¡Œå¤æ‚çš„é™æ€åˆå§‹åŒ–é€»è¾‘ã€‚

```javascript
class MyClass {
  static field1 = 'value1';
  static field2;
  static field3;
  
  // é™æ€åˆå§‹åŒ–å—
  static {
    // æ‰§è¡Œå¤æ‚çš„åˆå§‹åŒ–é€»è¾‘
    const initialData = fetchInitialData();
    this.field2 = initialData.field2;
    this.field3 = processData(initialData.field3);
    
    // å¯ä»¥è®¿é—®ç§æœ‰é™æ€å­—æ®µ
    this.#privateStaticField = 'initialized';
    
    // å¯ä»¥å®šä¹‰åªåœ¨åˆå§‹åŒ–æœŸé—´ä½¿ç”¨çš„è¾…åŠ©å‡½æ•°
    function fetchInitialData() {
      return { field2: 'value2', field3: 'raw-value3' };
    }
    
    function processData(data) {
      return data.toUpperCase();
    }
  }
  
  // ç§æœ‰é™æ€å­—æ®µ
  static #privateStaticField;
  
  // è·å–ç§æœ‰é™æ€å­—æ®µçš„æ–¹æ³•
  static getPrivateField() {
    return this.#privateStaticField;
  }
}

console.log(MyClass.field1); // 'value1'
console.log(MyClass.field2); // 'value2'
console.log(MyClass.field3); // 'RAW-VALUE3'
console.log(MyClass.getPrivateField()); // 'initialized'
```

## æ€»ç»“

ES2020åˆ°ES2024å¼•å…¥äº†è®¸å¤šå¼ºå¤§çš„æ–°ç‰¹æ€§ï¼Œè¿™äº›ç‰¹æ€§ä½¿JavaScriptæ›´åŠ ç°ä»£åŒ–ã€å¼ºå¤§å’Œæ˜“ç”¨ï¼š

- **ES2020 (ES11)** å¼•å…¥äº†å¯é€‰é“¾æ“ä½œç¬¦ã€ç©ºå€¼åˆå¹¶æ“ä½œç¬¦ã€Promise.allSettledã€BigIntç­‰ã€‚
- **ES2021 (ES12)** æ·»åŠ äº†String.prototype.replaceAllã€Promise.anyã€é€»è¾‘èµ‹å€¼è¿ç®—ç¬¦ç­‰ã€‚
- **ES2022 (ES13)** æ ‡å‡†åŒ–äº†ç±»å­—æ®µã€ç§æœ‰æ–¹æ³•ã€é¡¶å±‚awaitç­‰ã€‚
- **ES2023 (ES14)** å¼•å…¥äº†æ•°ç»„çš„findLast/findLastIndexæ–¹æ³•ã€Hashbangè¯­æ³•ç­‰ã€‚
- **ES2024 (ES15)** å¸¦æ¥äº†Promise.withResolversã€æ•°ç»„çš„éç ´åæ€§æ–¹æ³•ã€RegExp væ ‡å¿—ç­‰ã€‚

è¿™äº›ç‰¹æ€§å…±åŒæ¨åŠ¨äº†JavaScriptçš„å‘å±•ï¼Œä½¿å…¶æˆä¸ºä¸€ç§æ›´åŠ å¼ºå¤§å’Œæ˜“ç”¨çš„ç¼–ç¨‹è¯­è¨€ã€‚éšç€è¿™äº›ç‰¹æ€§çš„å¹¿æ³›æ”¯æŒï¼Œå¼€å‘è€…å¯ä»¥ç¼–å†™æ›´ç®€æ´ã€æ›´å¯ç»´æŠ¤çš„ä»£ç ï¼Œæé«˜å¼€å‘æ•ˆç‡å’Œåº”ç”¨æ€§èƒ½ã€‚

## æµè§ˆå™¨å’Œç¯å¢ƒæ”¯æŒ

å¤§å¤šæ•°ç°ä»£æµè§ˆå™¨ï¼ˆChromeã€Firefoxã€Safariã€Edgeï¼‰å’ŒNode.jsçš„æœ€æ–°ç‰ˆæœ¬éƒ½æ”¯æŒè¿™äº›ç‰¹æ€§ã€‚ä½†åœ¨ä½¿ç”¨è¿™äº›ç‰¹æ€§å‰ï¼Œå»ºè®®æŸ¥é˜…[Can I use](https://caniuse.com/)æˆ–[Node.jså…¼å®¹æ€§è¡¨](https://node.green/)ï¼Œç¡®ä¿ç›®æ ‡ç¯å¢ƒæ”¯æŒè¿™äº›ç‰¹æ€§ï¼Œæˆ–ä½¿ç”¨Babelç­‰å·¥å…·è¿›è¡Œè½¬è¯‘ã€‚

## å‚è€ƒèµ„æº

- [ECMAScript 2020 è§„èŒƒ](https://www.ecma-international.org/ecma-262/11.0/)
- [ECMAScript 2021 è§„èŒƒ](https://www.ecma-international.org/ecma-262/12.0/)
- [ECMAScript 2022 è§„èŒƒ](https://www.ecma-international.org/ecma-262/13.0/)
- [ECMAScript 2023 è§„èŒƒ](https://www.ecma-international.org/ecma-262/14.0/)
- [ECMAScript 2024 è§„èŒƒ](https://tc39.es/ecma262/)
- [MDN Web Docs: JavaScript](https://developer.mozilla.org/zh-CN/docs/Web/JavaScript)
- [TC39 ææ¡ˆ](https://github.com/tc39/proposals)