---
title: 文本编辑与导航命令
icon: navigation
order: 4
---

# 文本编辑与导航命令

## 导航命令基础

Vim 的导航系统设计精巧，遵循一套逻辑清晰的规则，让用户能够精确、高效地在文本中移动。掌握这些导航命令是提高编辑效率的关键。

### 基本光标移动

最基础的导航命令是 `h`、`j`、`k`、`l` 四个键，它们分别对应左、下、上、右四个方向：

| 命令 | 功能 | 记忆方式 |
|------|------|---------|
| `h` | 向左移动一个字符 | 位于左侧 |
| `j` | 向下移动一行 | 看起来像向下的箭头 |
| `k` | 向上移动一行 | 在 `j` 上方 |
| `l` | 向右移动一个字符 | 位于右侧 |

这四个键位于键盘的中心位置，使你无需移动手指即可控制光标，比使用方向键更加高效。

所有的移动命令都可以加上数字前缀来重复执行，例如：
- `5j` 向下移动 5 行
- `10l` 向右移动 10 个字符

### 单词级导航

单词级导航允许你更快地在文本中移动：

| 命令 | 功能 |
|------|------|
| `w` | 移动到下一个单词的开头 |
| `e` | 移动到当前单词或下一个单词的结尾 |
| `b` | 移动到当前单词或上一个单词的开头 |
| `ge` | 移动到上一个单词的结尾 |

Vim 中的"单词"默认由字母、数字和下划线组成，或者是由其他非空白字符组成的序列。如果你想按照空白字符分隔的"大单词"移动，可以使用大写命令：

| 命令 | 功能 |
|------|------|
| `W` | 移动到下一个大单词的开头 |
| `E` | 移动到当前大单词或下一个大单词的结尾 |
| `B` | 移动到当前大单词或上一个大单词的开头 |
| `gE` | 移动到上一个大单词的结尾 |

例如，在 `hello_world.example` 这个文本中：
- 使用 `w` 会将其视为三个单词：`hello_world`、`.`、`example`
- 使用 `W` 会将其视为一个大单词：`hello_world.example`

### 行内导航

行内导航命令帮助你快速定位到行内的特定位置：

| 命令 | 功能 |
|------|------|
| `0` | 移动到行首（第一个字符，包括空白字符） |
| `^` | 移动到行首（第一个非空白字符） |
| `$` | 移动到行尾 |
| `g_` | 移动到行尾最后一个非空白字符 |

还有一些特殊的行内导航命令：

| 命令 | 功能 |
|------|------|
| `f{char}` | 向右查找字符 `{char}` 并移动到该位置 |
| `F{char}` | 向左查找字符 `{char}` 并移动到该位置 |
| `t{char}` | 向右查找字符 `{char}` 并移动到该字符前一个位置 |
| `T{char}` | 向左查找字符 `{char}` 并移动到该字符后一个位置 |
| `;` | 重复上一次 `f`、`F`、`t` 或 `T` 命令 |
| `,` | 反向重复上一次 `f`、`F`、`t` 或 `T` 命令 |

这些命令特别适合在一行内快速定位。例如，如果你想移动到下一个逗号，可以使用 `f,`；如果想移动到下一个逗号前的位置，可以使用 `t,`。

## 高级导航技巧

### 段落和句子导航

Vim 提供了在更大文本单位上移动的命令：

| 命令 | 功能 |
|------|------|
| `{` | 移动到上一个空行（段落开始） |
| `}` | 移动到下一个空行（段落结束） |
| `(` | 移动到当前句子的开始 |
| `)` | 移动到下一个句子的开始 |

在 Vim 中，段落由空行分隔，句子由 `.`、`!` 或 `?` 后跟两个空格或行尾分隔。

### 屏幕导航

屏幕级导航命令帮助你在可见文本区域内快速移动：

| 命令 | 功能 |
|------|------|
| `H` | 移动到屏幕顶部（High） |
| `M` | 移动到屏幕中间（Middle） |
| `L` | 移动到屏幕底部（Low） |
| `zt` | 将当前行置于屏幕顶部（top） |
| `zz` | 将当前行置于屏幕中间（center） |
| `zb` | 将当前行置于屏幕底部（bottom） |

### 文件导航

文件级导航命令允许你在整个文件中快速移动：

| 命令 | 功能 |
|------|------|
| `gg` | 移动到文件开头 |
| `G` | 移动到文件末尾 |
| `{num}G` 或 `:{num}` | 移动到指定行号 |
| `Ctrl+f` | 向下翻页（Forward） |
| `Ctrl+b` | 向上翻页（Backward） |
| `Ctrl+d` | 向下翻半页（Down） |
| `Ctrl+u` | 向上翻半页（Up） |
| `Ctrl+e` | 向下滚动一行 |
| `Ctrl+y` | 向上滚动一行 |

### 搜索导航

搜索是 Vim 中另一种强大的导航方式：

| 命令 | 功能 |
|------|------|
| `/{pattern}` | 向前搜索 `{pattern}` |
| `?{pattern}` | 向后搜索 `{pattern}` |
| `n` | 重复上一次搜索（同方向） |
| `N` | 重复上一次搜索（反方向） |
| `*` | 向前搜索光标下的单词 |
| `#` | 向后搜索光标下的单词 |
| `g*` | 向前搜索光标下的单词（部分匹配） |
| `g#` | 向后搜索光标下的单词（部分匹配） |

Vim 的搜索支持正则表达式，使其成为一个强大的文本查找工具。例如：
- `/\<the\>` 搜索单词 "the"（而不是 "there" 或 "them" 中的 "the"）
- `/\d\+` 搜索一个或多个数字

### 标记和跳转

Vim 允许你在文件中设置标记，并快速跳转到这些标记：

| 命令 | 功能 |
|------|------|
| `m{a-zA-Z}` | 设置标记 |
| `` `{a-zA-Z}`` | 跳转到标记的确切位置 |
| `'{a-zA-Z}` | 跳转到标记所在行的第一个非空白字符 |

小写标记 `a-z` 是文件局部的，大写标记 `A-Z` 是全局的（可以在不同文件间跳转）。

Vim 还自动设置一些特殊标记：

| 标记 | 位置 |
|------|------|
| `` ` `` | 上一次跳转前的位置 |
| `` `. `` | 上一次修改的位置 |
| `` `^ `` | 上一次插入模式退出的位置 |
| `` `[ `` | 上一次修改或复制的第一行 |
| `` `] `` | 上一次修改或复制的最后一行 |
| `` `< `` | 上一次可视模式选择的开始 |
| `` `> `` | 上一次可视模式选择的结束 |

### 跳转列表和改变列表

Vim 维护两个特殊的列表来帮助导航：

1. **跳转列表**：记录你在文件中的"跳转"位置
   - `Ctrl+o` 跳转到较旧的位置
   - `Ctrl+i` 或 `Tab` 跳转到较新的位置

2. **改变列表**：记录你在文件中进行修改的位置
   - `g;` 跳转到较旧的修改位置
   - `g,` 跳转到较新的修改位置

这些命令对于在大文件中工作特别有用，可以帮助你在不同的工作区域之间快速切换。

## 文本编辑命令

Vim 的编辑命令遵循一种类似语言的结构，通常由"操作符+动作"组成。这种设计使得编辑命令既强大又灵活。

### 基本编辑操作符

| 操作符 | 功能 |
|--------|------|
| `d` | 删除（Delete） |
| `c` | 更改（Change）- 删除并进入插入模式 |
| `y` | 复制（Yank） |
| `p` | 粘贴（Put） |
| `>` | 增加缩进 |
| `<` | 减少缩进 |
| `=` | 自动缩进 |
| `!` | 通过外部命令过滤 |
| `gU` | 转换为大写 |
| `gu` | 转换为小写 |
| `~` | 切换大小写 |
| `g~` | 切换大小写（可与动作组合） |

这些操作符可以与任何动作命令组合使用，创建强大的编辑命令。

### 操作符与动作的组合

操作符后跟动作命令，表示对该动作覆盖的文本执行操作：

```
[操作符][数字][动作]
```

例如：
- `d2w` 删除两个单词
- `y$` 复制从光标到行尾的内容
- `c3j` 更改当前行和下面两行
- `>}` 增加当前段落的缩进
- `gU2e` 将从光标到第二个单词结尾的文本转换为大写

### 常用编辑命令组合

以下是一些常用的编辑命令组合：

| 命令 | 功能 |
|------|------|
| `dd` | 删除当前行 |
| `cc` 或 `S` | 删除当前行并进入插入模式 |
| `yy` 或 `Y` | 复制当前行 |
| `D` | 删除从光标到行尾 |
| `C` | 删除从光标到行尾并进入插入模式 |
| `x` | 删除光标下的字符（等同于 `dl`） |
| `X` | 删除光标前的字符（等同于 `dh`） |
| `s` | 删除光标下的字符并进入插入模式（等同于 `cl`） |
| `r{char}` | 将光标下的字符替换为 `{char}` |
| `R` | 进入替换模式 |
| `J` | 连接当前行和下一行 |
| `gJ` | 连接当前行和下一行（不添加空格） |
| `>>` | 增加当前行的缩进 |
| `<<` | 减少当前行的缩进 |
| `==` | 自动缩进当前行 |
| `~` | 切换光标下字符的大小写 |
| `.` | 重复上一次更改 |

### 文本对象

Vim 的文本对象是一种特殊的动作，它们定义了文本的结构化部分。文本对象通常与操作符一起使用，格式为：

```
[操作符][i/a][文本对象]
```

其中：
- `i` 表示"内部"（inside）
- `a` 表示"周围"（around）- 包括分隔符

常用的文本对象包括：

| 文本对象 | 描述 |
|---------|------|
| `w` | 单词 |
| `s` | 句子 |
| `p` | 段落 |
| `[` 或 `]` | 一对方括号 |
| `(` 或 `)` | 一对圆括号 |
| `{` 或 `}` | 一对花括号 |
| `<` 或 `>` | 一对尖括号 |
| `'` | 一对单引号 |
| `"` | 一对双引号 |
| `` ` `` | 一对反引号 |
| `t` | 一对 XML/HTML 标签 |

例如：
- `diw` 删除光标所在的整个单词（delete inside word）
- `ci"` 删除双引号内的内容并进入插入模式（change inside quotes）
- `ya(` 复制包括圆括号在内的整个内容（yank around parentheses）
- `dit` 删除 HTML 标签内的内容（delete inside tag）

文本对象是 Vim 最强大的功能之一，它们使精确编辑结构化文本变得简单高效。

### 复制和粘贴

Vim 的复制（yank）和粘贴（put）系统使用寄存器来存储文本：

| 命令 | 功能 |
|------|------|
| `y{motion}` | 复制文本到无名寄存器 |
| `"{register}y{motion}` | 复制文本到指定寄存器 |
| `p` | 在光标后粘贴 |
| `P` | 在光标前粘贴 |
| `"{register}p` | 从指定寄存器粘贴 |
| `gp` | 在光标后粘贴并将光标置于粘贴文本之后 |
| `gP` | 在光标前粘贴并将光标置于粘贴文本之后 |

Vim 有多种寄存器：
- 无名寄存器 `"` - 默认寄存器
- 命名寄存器 `"a` 到 `"z` - 用户定义的寄存器
- 数字寄存器 `"0` 到 `"9` - `"0` 存储最近一次复制的内容，`"1` 到 `"9` 存储最近删除的内容
- 小删除寄存器 `"-` - 存储小于一行的删除
- 系统剪贴板 `"+` - 与系统剪贴板交互
- 选择寄存器 `"*` - 与系统选择缓冲区交互
- 表达式寄存器 `"=` - 用于计算表达式
- 只读寄存器 `":`, `".`, `"%` - 分别存储最近命令、最近插入文本和当前文件名

例如，要将文本复制到寄存器 `a` 并粘贴：
```
"ayy  # 复制当前行到寄存器 a
"ap   # 从寄存器 a 粘贴
```

要与系统剪贴板交互：
```
"+yy  # 复制当前行到系统剪贴板
"+p   # 从系统剪贴板粘贴
```

### 撤销和重做

Vim 提供了强大的撤销和重做功能：

| 命令 | 功能 |
|------|------|
| `u` | 撤销上一次更改 |
| `Ctrl+r` | 重做被撤销的更改 |
| `U` | 撤销对当前行的所有更改 |

Vim 的撤销系统是分支的，这意味着你可以撤销到文件的任何先前状态，即使在执行了重做操作之后：

```
g-    # 回到较旧的文本状态
g+    # 回到较新的文本状态
:earlier {time}  # 回到 {time} 之前的状态，如 :earlier 10m（10分钟前）
:later {time}    # 回到 {time} 之后的状态
```

### 宏录制与回放

宏是一系列命令的记录，可以回放以自动化重复任务：

| 命令 | 功能 |
|------|------|
| `q{a-z}` | 开始录制宏到寄存器 {a-z} |
| `q` | 停止录制宏 |
| `@{a-z}` | 执行寄存器 {a-z} 中的宏 |
| `@@` | 重复上一次执行的宏 |
| `{count}@{a-z}` | 执行宏 {count} 次 |

例如，要录制一个将当前行转换为大写并移动到下一行的宏：
```
qa    # 开始录制到寄存器 a
gUU   # 将当前行转换为大写
j     # 移动到下一行
q     # 停止录制
```

然后，你可以使用 `@a` 执行这个宏，或使用 `5@a` 对接下来的 5 行执行这个宏。

## 高级编辑技巧

### 多行编辑

Vim 提供了几种方法来同时编辑多行：

1. **可视块模式**：
   - 按 `Ctrl+v` 进入可视块模式
   - 选择要编辑的列块
   - 按 `I` 在块的开头插入文本，或按 `A` 在块的结尾插入文本
   - 编辑完成后按 `Esc`，更改将应用到所有选中的行

2. **全局命令**：
   - `:g/pattern/command` 对匹配 pattern 的每一行执行 command
   - 例如，`:g/TODO/d` 删除所有包含 "TODO" 的行

3. **替换命令**：
   - `:[range]s/pattern/replacement/[flags]` 在指定范围内替换文本
   - 例如，`:%s/old/new/g` 全局替换 "old" 为 "new"

4. **正常模式命令**：
   - `:[range]normal commands` 对指定范围的每一行执行普通模式命令
   - 例如，`:1,10normal I// ` 对前 10 行添加注释

### 缩进和格式化

Vim 提供了多种缩进和格式化文本的方法：

| 命令 | 功能 |
|------|------|
| `>>` | 增加当前行的缩进 |
| `<<` | 减少当前行的缩进 |
| `>{motion}` | 增加指定范围的缩进 |
| `<{motion}` | 减少指定范围的缩进 |
| `=={motion}` | 自动缩进指定范围 |
| `gg=G` | 自动缩进整个文件 |
| `gq{motion}` | 格式化文本以适应 `textwidth` |
| `gw{motion}` | 格式化文本以适应 `textwidth`，但保持光标位置 |
| `J` | 连接当前行和下一行 |
| `gJ` | 连接当前行和下一行（不添加空格） |

### 折叠

Vim 的折叠功能允许你隐藏文本块，使导航和编辑更加高效：

| 命令 | 功能 |
|------|------|
| `zf{motion}` | 创建折叠 |
| `zo` | 打开折叠 |
| `zc` | 关闭折叠 |
| `za` | 切换折叠状态 |
| `zR` | 打开所有折叠 |
| `zM` | 关闭所有折叠 |
| `zj` | 移动到下一个折叠 |
| `zk` | 移动到上一个折叠 |

### 窗口和标签页

Vim 允许你同时编辑多个文件，使用窗口和标签页：

**窗口命令**：
| 命令 | 功能 |
|------|------|
| `:split [file]` | 水平分割窗口 |
| `:vsplit [file]` | 垂直分割窗口 |
| `Ctrl+w h/j/k/l` | 在窗口之间导航 |
| `Ctrl+w +/-` | 调整窗口高度 |
| `Ctrl+w </>`| 调整窗口宽度 |
| `Ctrl+w =` | 使所有窗口等大 |
| `:close` | 关闭当前窗口 |
| `:only` | 关闭除当前窗口外的所有窗口 |

**标签页命令**：
| 命令 | 功能 |
|------|------|
| `:tabnew [file]` | 在新标签页中打开文件 |
| `:tabnext` 或 `gt` | 切换到下一个标签页 |
| `:tabprevious` 或 `gT` | 切换到上一个标签页 |
| `:tabclose` | 关闭当前标签页 |
| `:tabs` | 列出所有标签页 |

## 实用编辑场景

### 重构代码

假设你需要重命名一个变量，可以使用以下步骤：

1. 将光标放在变量上
2. 按 `*` 搜索该变量的所有出现
3. 使用 `:%s//new_name/gc` 替换所有出现（`//` 使用上一次搜索的模式）
4. 对每次替换进行确认（`c` 标志）

### 格式化 JSON 数据

如果你有一行未格式化的 JSON 数据，可以使用外部命令格式化它：

```
:%!python -m json.tool
```

或者，如果你有 `jq` 工具：

```
:%!jq .
```

### 排序列表

要对文本行进行排序：

```
:[range]sort [i][u][n][r][x][o]
```

选项：
- `i` - 忽略大小写
- `u` - 删除重复行
- `n` - 按数字排序
- `r` - 反向排序
- `x` - 按十六进制排序
- `o` - 按八进制排序

例如，要对整个文件进行排序并删除重复行：

```
:%sort u
```

### 批量注释/取消注释

使用可视块模式批量注释多行：

1. 按 `Ctrl+v` 进入可视块模式
2. 选择要注释的行的开头
3. 按 `I` 进入插入模式
4. 输入注释字符（如 `//` 或 `#`）
5. 按 `Esc` 应用更改到所有选中的行

要取消注释：

1. 按 `Ctrl+v` 进入可视块模式
2. 选择注释字符
3. 按 `d` 删除选中的块

## 提高编辑效率的技巧

### 使用 `.` 命令

`.` 命令是 Vim 中最强大的命令之一，它重复上一次更改。结合其他命令，可以大大提高编辑效率：

1. 使用精确的更改命令（如 `cw` 而不是多次按 `x` 然后 `i`）
2. 移动到下一个需要更改的位置
3. 按 `.` 重复更改

### 使用寄存器有效地复制粘贴

1. 使用命名寄存器存储多个文本片段
2. 使用 `"0p` 粘贴最近复制的内容（而不是最近删除的内容）
3. 使用系统剪贴板寄存器 (`"+`) 与其他应用程序交互

### 组合命令创建强大的编辑序列

学会组合命令创建复杂的编辑序列。例如，要删除从当前位置到下一个空行：

```
d}
```

要更改从当前位置到下一个括号内的所有内容：

```
ct)
```

### 使用标记进行快速导航

在编辑大文件时，使用标记来快速在不同位置之间跳转：

1. 使用 `ma` 在重要位置设置标记 `a`
2. 在文件中导航
3. 使用 `` `a`` 快速返回到标记位置

### 利用文本对象进行精确编辑

文本对象使精确编辑变得简单。例如，无论光标在单词的哪个位置，`ciw` 都会更改整个单词。

## 总结

Vim 的文本编辑和导航命令构成了一个强大而灵活的系统，允许用户以前所未有的效率编辑文本。这些命令的关键特性包括：

1. **组合性**：简单命令可以组合成复杂操作
2. **精确性**：文本对象允许精确定位和操作结构化文本
3. **效率**：最小化按键次数，最大化编辑效率
4. **一致性**：命令遵循一致的模式，易于学习和记忆

掌握这些命令需要时间和实践，但回报是巨大的。随着经验的积累，你会发现自己能够以思考的速度编辑文本，而不是被工具所限制。

记住，Vim 的学习曲线是渐进的。从基本移动和编辑命令开始，逐步添加新技能。使用 `:help` 命令探索更多功能，并定期练习新学到的命令，直到它们成为肌肉记忆的一部分。